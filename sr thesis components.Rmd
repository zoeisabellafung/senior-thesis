---
title: "sr thesis components"
author: "Zoe Fung"
date: "8/31/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
# load required packages
library(readr)
library(ggplot2)
library(tibble)
library(janitor)
library(plyr)
library(dplyr)
library(stringr)
library(tidyr)
library(forcats)
library(ggthemes)
```

## data cleaning 

### pre-fire 

#### laguna mountain
```{r}
# read in laguna mountain data
laguna_pre <- read_csv("data/Nicole/LagunaMtn_pre_2016.csv") %>%
  clean_names() %>% # standardize column names
  select(project, date, id, treatment, tag_number, status, species, dbh_cm, height_m, heigt_to_crown_m, dbh_ft, basal_area_sq_ft_indiv) %>% # subset data 
  as.data.frame() %>%
  rename("height_to_crown_m"="heigt_to_crown_m", "plot_id"="id", "treatment_unit"="treatment")
laguna_pre <- laguna_pre %>%
  mutate(tree_area = ((pi*(laguna_pre$dbh_cm^2)/4)/100)) # add column w/ area measurements for each tree

# load in raw pre-fire laguna mountain data (2020)

# setwd("data/Nicole/laguna/lagunamtnpre") 
# laguna_pre <- ldply(list.files(), read.csv, header=TRUE) # doesn't work

lm_128 <- read.csv("data/Nicole/laguna/lagunamtnpre/LM_128_2020_trees.csv") %>%
  mutate(plot_id = rep(128, length = 8))
lm_129 <- read.csv("data/Nicole/laguna/lagunamtnpre/LM_129_2020_trees.csv") %>%
  mutate(plot_id = rep(129, length = 12))
lm_130 <- read.csv("data/Nicole/laguna/lagunamtnpre/LM_130_2020_trees.csv") %>%
  mutate(plot_id = rep(130, length = 12))
lm_131 <- read.csv("data/Nicole/laguna/lagunamtnpre/LM_131_2020_trees.csv") %>%
  mutate(plot_id = rep(131, length = 7))
lm_132 <- read.csv("data/Nicole/laguna/lagunamtnpre/LM_132_2020_trees.csv") %>%
  mutate(plot_id = rep(132, length = 3))
lm_133 <- read.csv("data/Nicole/laguna/lagunamtnpre/LM_133_2020_trees.csv") %>%
  mutate(plot_id = rep(133, length = 6))
lm_134 <- read.csv("data/Nicole/laguna/lagunamtnpre/LM_134_2020_trees.csv") %>%
  mutate(plot_id = rep(134, length = 10))
lm_135 <- read.csv("data/Nicole/laguna/lagunamtnpre/LM_135_2020_trees.csv") %>%
  mutate(plot_id = rep(135, length = 6))
lm_137 <- read.csv("data/Nicole/laguna/lagunamtnpre/LM_137_2020_trees.csv") %>%
  mutate(plot_id = rep(137, length = 7))
lm_138 <- read.csv("data/Nicole/laguna/lagunamtnpre/LM_138_2020_trees.csv") %>%
  mutate(plot_id = rep(138, length = 7))
lm_139 <- read.csv("data/Nicole/laguna/lagunamtnpre/LM_139_2020_trees.csv") %>%
  mutate(plot_id = rep(139, length = 6))
lm_140 <- read.csv("data/Nicole/laguna/lagunamtnpre/LM_140_2020_trees.csv") %>%
  mutate(plot_id = rep(140, length = 7))
lm_141 <- read.csv("data/Nicole/laguna/lagunamtnpre/LM_141_2020_trees.csv") %>%
  mutate(plot_id = rep(141, length = 8))
lm_142 <- read.csv("data/Nicole/laguna/lagunamtnpre/LM_142_2020_trees.csv") %>%
  mutate(plot_id = rep(142, length = 8))
lm_143 <- read.csv("data/Nicole/laguna/lagunamtnpre/LM_143_2020_trees.csv") %>%
  mutate(plot_id = rep(143, length = 10))
lm_144 <- read.csv("data/Nicole/laguna/lagunamtnpre/LM_144_2020_trees.csv") %>%
  mutate(plot_id = rep(144, length = 6))
lm_170 <- read.csv("data/Nicole/laguna/lagunamtnpre/LM_170_2021_trees.csv") %>%
  mutate(plot_id = rep(170, length = 7))
lm_171 <- read.csv("data/Nicole/laguna/lagunamtnpre/LM_171_2021_trees.csv") %>%
  mutate(plot_id = rep(171, length = 8))
lm_172 <- read.csv("data/Nicole/laguna/lagunamtnpre/LM_172_2020_trees.csv") %>%
  mutate(plot_id = rep(172, length = 9))
lm_173 <- read.csv("data/Nicole/laguna/lagunamtnpre/LM_173_2021_trees.csv") %>%
  mutate(plot_id = rep(173, length = 15))
lm_175 <- read.csv("data/Nicole/laguna/lagunamtnpre/LM_175_2021_trees.csv") %>%
  mutate(plot_id = rep(175, length = 8))
lm_176 <- read.csv("data/Nicole/laguna/lagunamtnpre/LM_176_2021_trees.csv") %>%
  mutate(plot_id = rep(176, length = 7))
lm_177 <- read.csv("data/Nicole/laguna/lagunamtnpre/LM_177_2021_trees.csv") %>%
  mutate(plot_id = rep(177, length = 7))
lm_179 <- read.csv("data/Nicole/laguna/lagunamtnpre/LM_179_2021_trees.csv") %>%
  mutate(plot_id = rep(179, length = 6))
lm_180 <- read.csv("data/Nicole/laguna/lagunamtnpre/LM_180_2021_trees.csv") %>%
  mutate(plot_id = rep(180, length = 17))
lm_181 <- read.csv("data/Nicole/laguna/lagunamtnpre/LM_181_2021_trees.csv") %>%
  mutate(plot_id = rep(181, length = 19))
lm_195 <- read.csv("data/Nicole/laguna/lagunamtnpre/LM_195_2021_trees.csv") %>%
  mutate(plot_id = rep(195, length = 25))
lm_196 <- read.csv("data/Nicole/laguna/lagunamtnpre/LM_196_2021_trees.csv") %>%
  mutate(plot_id = rep(196, length = 8))
lm_197 <- read.csv("data/Nicole/laguna/lagunamtnpre/LM_197_2021_trees.csv") %>%
  mutate(plot_id = rep(197, length = 5))
lm_198 <- read.csv("data/Nicole/laguna/lagunamtnpre/LM_198_2021_trees.csv") %>%
  mutate(plot_id = rep(198, length = 7))
lm_199 <- read.csv("data/Nicole/laguna/lagunamtnpre/LM_199_2021_trees.csv") %>%
  mutate(plot_id = rep(199, length = 12))
lm_200 <- read.csv("data/Nicole/laguna/lagunamtnpre/LM_200_2021_trees.csv") %>%
  mutate(plot_id = rep(200, length = 11))

# combine raw pre-fire laguna data into one data frame
laguna_pre <- rbind(
  lm_128, lm_129, lm_130, lm_131, lm_132, lm_133, lm_134, lm_135, lm_137, lm_138, lm_139, lm_140, lm_141, lm_142, lm_143, lm_144, lm_170, lm_171, lm_172, lm_173, lm_175, lm_176, lm_177, lm_179, lm_180, lm_181, lm_195, lm_196, lm_197, lm_198, lm_199, lm_200) %>%
  clean_names() %>%
  select(plot_id, species, tag_no, status, dbh, ht, crwn_rto, crwn_rad, char_ht, scorch_ht, cr_sc_pct, uv1, uv2, uv3) %>%
  mutate(location = rep("Laguna", rep = 294))
```

#### bluff mesa
```{r}
# read in raw pre-fire bluff mesa data (2020)
bm_24_2020_trees <- read.csv("data/Nicole/bluffmesa/BM_24_2020_trees.csv") %>%
  mutate(plot_id = rep(24, length = 8))
bm_25_2020_trees <- read.csv("data/Nicole/bluffmesa/BM_25_2020_trees.csv") %>%
   mutate(plot_id = rep(25, length = 4))
bm_26_2020_trees <- read.csv("data/Nicole/bluffmesa/BM_26_2020_trees.csv") %>%
   mutate(plot_id = rep(26, length = 3))
bm_27_2020_trees <- read.csv("data/Nicole/bluffmesa/BM_27_2020_trees.csv") %>%
   mutate(plot_id = rep(27, length = 3))
bm_33_2020_trees <- read.csv("data/Nicole/bluffmesa/BM_33_2020_trees.csv") %>%
   mutate(plot_id = rep(33, length = 4))
bm_48_2020_trees <- read.csv("data/Nicole/bluffmesa/BM_48_2020_trees.csv") %>%
   mutate(plot_id = rep(48, length = 6))
bm_49_2020_trees <- read.csv("data/Nicole/bluffmesa/BM_49_2020_trees.csv") %>%
   mutate(plot_id = rep(49, length = 10))
bm_50_2020_trees <- read.csv("data/Nicole/bluffmesa/BM_50_2020_trees.csv") %>% 
   mutate(plot_id = rep(50, length = 4))
bm_51_2020_trees <- read.csv("data/Nicole/bluffmesa/BM_51_2020_trees.csv") %>%
   mutate(plot_id = rep(51, length = 4))
bm_52_2020_trees <- read.csv("data/Nicole/bluffmesa/BM_52_2020_trees.csv") %>%
   mutate(plot_id = rep(52, length = 3))
bm_53_2020_trees <- read.csv("data/Nicole/bluffmesa/BM_53_2020_trees.csv") %>%
   mutate(plot_id = rep(53, length = 5))

# combine raw pre-fire bluff mesa data into one data frame
bluffmesa_pre <- rbind(
  bm_24_2020_trees, bm_25_2020_trees, bm_26_2020_trees, bm_27_2020_trees, bm_33_2020_trees, bm_48_2020_trees, bm_49_2020_trees, bm_50_2020_trees, bm_51_2020_trees, bm_52_2020_trees, bm_53_2020_trees) %>%
  clean_names() %>%
  select(plot_id, species, tag_no, status, dbh, ht, crwn_rto, crwn_rad, char_ht, scorch_ht, cr_sc_pct, uv1, uv2, uv3) %>%
  mutate(location = rep("Bluff Mesa", length = 54))
```

#### thomas fire
```{r}
# read in thomas fire data
thomas1 <- read.csv("data/Nicole/thomas/TF_postfire_2018.csv") %>%
  clean_names() %>%
  slice_head(n = 67) %>%
  as.data.frame() %>%
  mutate(plot_id = c("PIPO-1", "PIPO-1", "PIPO-1", "PIPO-1", "PIPO-1", "PIPO-1", "PIPO-1", "PIPO-1", "PIPO-1", "PIPO-1", "PIPO-1", "PIPO-1", "PIPO-2", "PIPO-2", "PIPO-2", "PIPO-2", "PIPO-2", "PIPO-3", "PIPO-3", "PIPO-3", "PIPO-3", "PIPO-3", "PIPO-3", "PIPO-3", "PIPO-3", "PIPO-3", "PIPO-3", "PIPO-3", "PIPO-3", "PIPO-3", "PIPO-3", "PIPO-3", "PIPO-3", "PIPO-3", "PIPO-3", "PIPO-3", "PIPO-3", "PIPO-3", "PIPO-1", "PIPO-1", "PIPO-1", "PIPO-1", "PIPO-1", "PIPO-1", "PIPO-1", "PIPO-1", "PIPO-1", "PIPO-1", "PIPO-1", "PIPO-1", "PIPO-1", "PIPO-1", "PIPO-1", "PIPO-1", "PIPO-1", "PIPO-1", "PIPO-1", "PIPO-1", "PIPO-1", "PIPO-1", "PIPO-1", "PIPO-1", "PIPO-1", "PIPO-1", "PIPO-1", "PIPO-1", "PIPO-1")) %>%
  mutate(uv1 = rep("NA", length = 67)) %>%
  mutate(uv2 = rep("NA", length = 67)) %>%
  mutate(uv3 = rep("NA", length = 67)) %>%
  mutate(height_m = na_if(height_m, "NO DATA")) 

ht <- thomas1$height_m %>%
    as.numeric(unlist("height_m"))

# add new column to thomas 1
thomas1$ht <- ht

thomas1 <- thomas1 %>%
  rename("location" = "project", "tag_no" = "tree", "dbh" = "dbh_cm", "char_ht" = "torch_height_m", "scorch_ht" = "scorch_height_m") %>% # NOTE: ARE TORCH AND CHAR THE SAME THING?
  mutate(crwn_rto = (((ht - height_to_crown_base)/ht)*100)) %>% # calculate crown ratio from tree height & height to crown 
  mutate(crwn_rad = (crown_width)/2) %>% # calculate crown radius from crown width 
  mutate(tree_area = ((pi*(dbh^2)/4)/100)) %>% # calculate tree area from dbh
  mutate(category = rep("post", length = 67)) %>%
  mutate(cr_sc_pct = (100-percent_green)) %>%
  select(plot_id, species, tag_no, status, dbh, ht, crwn_rto, crwn_rad, char_ht, scorch_ht, cr_sc_pct, uv1, uv2, uv3, location, tree_area, category) 

thomas2 <- read.csv("data/Nicole/thomas/TF_postfire_2018-2.csv") %>%
  clean_names() %>%
  slice_head(n = 35) %>%
  mutate(uv1 = rep("NA", length = 35)) %>%
  mutate(uv2 = rep("NA", length = 35)) %>%
  mutate(uv3 = rep("NA", length = 35)) %>%
  mutate(percent_green = rep("NA", length = 35)) %>% 
  rename("location" = "project", "tag_no" = "tag", "dbh" = "dbh_cm", "ht" = "height_m", "char_ht" = "torch_ht", "cr_sc_pct" = "percent_green") %>% # NOTE: ARE TORCH AND CHAR THE SAME THING?
  mutate(crwn_rto = (((ht - heigt_to_crown_m)/ht)*100)) %>% # calculate crown ratio from tree height & height to crown 
  mutate(crwn_rad = (crown_width)/2) %>% # calculate crown radius from crown width 
  mutate(tree_area = ((pi*(dbh^2)/4)/100)) %>% # calculate tree area from dbh
  mutate(category = rep("post", length = 35)) %>%
  select(plot_id, species, tag_no, status, dbh, ht, crwn_rto, crwn_rad, char_ht, scorch_ht, cr_sc_pct, uv1, uv2, uv3, location, tree_area, category) 

thomas3 <- read.csv("data/Nicole/thomas/TF_postfire_2018-3.csv") %>%
  clean_names() %>%
  slice_head(n = 137) %>%
  mutate(uv1 = rep("NA", length = 137)) %>%
  mutate(uv2 = rep("NA", length = 137)) %>%
  mutate(uv3 = rep("NA", length = 137)) %>%
  mutate(percent_green = rep("NA", length = 137)) %>%
  mutate(heigt_to_crown_m = na_if(heigt_to_crown_m, "-")) %>%
  as.data.frame()

ht <- thomas3$height_m %>%
    as.numeric(unlist("height_m"))

height_to_crown_m <- thomas3$heigt_to_crown_m %>%
  as.numeric(unlist("heigt_to_crown_m"))

crown_wid <- thomas3$crown_width %>%
    as.numeric(unlist("crown_width"))

# add new column to thomas 1
thomas3$ht <- ht
thomas3$height_to_crown_m <- height_to_crown_m
thomas3$crown_wid <- crown_wid

thomas3 <- thomas3 %>%
  rename("location" = "project", "tag_no" = "tag", "dbh" = "dbh_cm", "char_ht" = "torch_ht", "cr_sc_pct" = "percent_green") %>% # NOTE: ARE TORCH AND CHAR THE SAME THING?
  mutate(crwn_rto = (((ht - height_to_crown_m)/ht)*100)) %>% # calculate crown ratio from tree height & height to crown 
  mutate(crwn_rad = (crown_wid)/2) %>% # calculate crown radius from crown width 
  mutate(tree_area = ((pi*(dbh^2)/4)/100)) %>% # calculate tree area from dbh
  mutate(category = rep("post", length = 137)) %>%
  select(plot_id, species, tag_no, status, dbh, ht, crwn_rto, crwn_rad, char_ht, scorch_ht, cr_sc_pct, uv1, uv2, uv3, location, tree_area, category) 

# combine all thomas fire data
thomas_post <- rbind(
  thomas1, thomas2, thomas3)
```

#### combine all pre-fire data
```{r}
# combine laguna mountain and bluff mesa data into one sheet
prefire_whole <- rbind(
  laguna_pre, bluffmesa_pre
) %>%
  mutate(category = rep("pre", length = 348))
```

#### coordinate data
```{r}
# laguna mtn coordinates
LM_coord <- read.csv("data/Nicole/laguna/LM_coordinates.csv") %>%
  clean_names() %>%
  select(site_year, plot_id, easting, northing) %>%
  filter(plot_id > 127) %>%
  filter(!duplicated(plot_id))

# bluff mesa coordinates
BM_coord <- read.csv("data/Nicole/bluffmesa/BM_coordinates.csv") %>%
  clean_names() %>%
  select(site_year, plot_id, easting, northing) %>%
  filter(plot_id > 23) %>%
  filter(plot_id < 54) %>%
  slice(-(1:3)) %>%
  filter(!duplicated(plot_id))

# thomas fire coordinates
TF_coord <- read.csv("data/Nicole/thomas/TF_coord.csv") %>%
  clean_names() %>%
  select(site_year, plot_id, easting, northing) %>%
  slice(-(1))
```

### abundance
#### laguna mountain
```{r}
# calculation for tree area measurement
laguna_pre <- laguna_pre %>%
  mutate(tree_area = ((pi*(laguna_pre$dbh^2)/4)/100))
bluffmesa_pre <- bluffmesa_pre %>%
  mutate(tree_area = ((pi*(bluffmesa_pre$dbh^2)/4)/100)) # add column with area measurements for each tree (cm^2)

# since location data is organized by PLOT, find tree area per plot (subset by species)
laguna_species <- unique(laguna_pre$species) # create list of all species present in laguna fire data

laguna_pre_PIJE <- filter(laguna_pre, species == "PIJE") # create data frame w/ only PIJE sp.
laguna_pre_QUKE <- filter(laguna_pre, species == "QUKE") # create data frame w/ only QUKE sp.

#### PIJE

laguna_pre_PIJE_plots <- unique(laguna_pre_PIJE$plot_id) # print each plot ID where PIJE is present

# create a data frame for each plot 
## NOTE: each plot is an 11.3m radius circular plot
laguna_pre_PIJE_128 <- filter(laguna_pre_PIJE, plot_id == "128")
laguna_pre_PIJE_129 <- filter(laguna_pre_PIJE, plot_id == "129")
laguna_pre_PIJE_130 <- filter(laguna_pre_PIJE, plot_id == "130")
laguna_pre_PIJE_131 <- filter(laguna_pre_PIJE, plot_id == "131")
laguna_pre_PIJE_132 <- filter(laguna_pre_PIJE, plot_id == "132")
laguna_pre_PIJE_133 <- filter(laguna_pre_PIJE, plot_id == "133")
laguna_pre_PIJE_134 <- filter(laguna_pre_PIJE, plot_id == "134")
laguna_pre_PIJE_135 <- filter(laguna_pre_PIJE, plot_id == "135")
laguna_pre_PIJE_137 <- filter(laguna_pre_PIJE, plot_id == "137")
laguna_pre_PIJE_138 <- filter(laguna_pre_PIJE, plot_id == "138")
laguna_pre_PIJE_139 <- filter(laguna_pre_PIJE, plot_id == "139")
laguna_pre_PIJE_140 <- filter(laguna_pre_PIJE, plot_id == "140")
laguna_pre_PIJE_141 <- filter(laguna_pre_PIJE, plot_id == "141")
laguna_pre_PIJE_142 <- filter(laguna_pre_PIJE, plot_id == "142")
laguna_pre_PIJE_143 <- filter(laguna_pre_PIJE, plot_id == "143")
laguna_pre_PIJE_144 <- filter(laguna_pre_PIJE, plot_id == "144")
laguna_pre_PIJE_170 <- filter(laguna_pre_PIJE, plot_id == "170")
laguna_pre_PIJE_171 <- filter(laguna_pre_PIJE, plot_id == "171")
laguna_pre_PIJE_172 <- filter(laguna_pre_PIJE, plot_id == "172")
laguna_pre_PIJE_173 <- filter(laguna_pre_PIJE, plot_id == "173")
laguna_pre_PIJE_175 <- filter(laguna_pre_PIJE, plot_id == "175")
laguna_pre_PIJE_176 <- filter(laguna_pre_PIJE, plot_id == "176")
laguna_pre_PIJE_177 <- filter(laguna_pre_PIJE, plot_id == "177")
laguna_pre_PIJE_179 <- filter(laguna_pre_PIJE, plot_id == "179")
laguna_pre_PIJE_180 <- filter(laguna_pre_PIJE, plot_id == "180")
laguna_pre_PIJE_181 <- filter(laguna_pre_PIJE, plot_id == "181")
laguna_pre_PIJE_195 <- filter(laguna_pre_PIJE, plot_id == "195")
laguna_pre_PIJE_197 <- filter(laguna_pre_PIJE, plot_id == "197")
laguna_pre_PIJE_198 <- filter(laguna_pre_PIJE, plot_id == "198")
laguna_pre_PIJE_199 <- filter(laguna_pre_PIJE, plot_id == "199")
laguna_pre_PIJE_200 <- filter(laguna_pre_PIJE, plot_id == "200")

# calculate plot area
plot_area <- pi*(11.3^2)
## plot area = 401.15m^2

# create vectors of the sum of each species' area per plot
l_p_128 <- sum(laguna_pre_PIJE_128$tree_area)
l_p_129 <- sum(laguna_pre_PIJE_129$tree_area)
l_p_130 <- sum(laguna_pre_PIJE_130$tree_area)
l_p_131 <- sum(laguna_pre_PIJE_131$tree_area)
l_p_132 <- sum(laguna_pre_PIJE_132$tree_area)
l_p_133 <- sum(laguna_pre_PIJE_133$tree_area)
l_p_134 <- sum(laguna_pre_PIJE_134$tree_area)
l_p_135 <- sum(laguna_pre_PIJE_135$tree_area)
l_p_137 <- sum(laguna_pre_PIJE_137$tree_area)
l_p_138 <- sum(laguna_pre_PIJE_138$tree_area)
l_p_139 <- sum(laguna_pre_PIJE_139$tree_area)
l_p_140 <- sum(laguna_pre_PIJE_140$tree_area)
l_p_141 <- sum(laguna_pre_PIJE_141$tree_area)
l_p_142 <- sum(laguna_pre_PIJE_142$tree_area)
l_p_143 <- sum(laguna_pre_PIJE_143$tree_area)
l_p_144 <- sum(laguna_pre_PIJE_144$tree_area)
l_p_170 <- sum(laguna_pre_PIJE_170$tree_area)
l_p_171 <- sum(laguna_pre_PIJE_171$tree_area)
l_p_172 <- sum(laguna_pre_PIJE_172$tree_area)
l_p_173 <- sum(laguna_pre_PIJE_173$tree_area)
l_p_175 <- sum(laguna_pre_PIJE_175$tree_area)
l_p_176 <- sum(laguna_pre_PIJE_176$tree_area)
l_p_177 <- sum(laguna_pre_PIJE_177$tree_area)
l_p_179 <- sum(laguna_pre_PIJE_179$tree_area)
l_p_180 <- sum(laguna_pre_PIJE_180$tree_area)
l_p_181 <- sum(laguna_pre_PIJE_181$tree_area)
l_p_195 <- sum(laguna_pre_PIJE_195$tree_area)
l_p_197 <- sum(laguna_pre_PIJE_197$tree_area)
l_p_198 <- sum(laguna_pre_PIJE_198$tree_area)
l_p_199 <- sum(laguna_pre_PIJE_199$tree_area)
l_p_200 <- sum(laguna_pre_PIJE_200$tree_area)

# create vectors of average height of each species per plot
h_128 <- mean(laguna_pre_PIJE_128$ht)
h_129 <- mean(laguna_pre_PIJE_129$ht)
h_130 <- mean(laguna_pre_PIJE_130$ht)
h_131 <- mean(laguna_pre_PIJE_131$ht)
h_132 <- mean(laguna_pre_PIJE_132$ht)
h_133 <- mean(laguna_pre_PIJE_133$ht)
h_134 <- mean(laguna_pre_PIJE_134$ht)
h_135 <- mean(laguna_pre_PIJE_135$ht)
h_137 <- mean(laguna_pre_PIJE_137$ht)
h_138 <- mean(laguna_pre_PIJE_138$ht)
h_139 <- mean(laguna_pre_PIJE_139$ht)
h_140 <- mean(laguna_pre_PIJE_140$ht)
h_141 <- mean(laguna_pre_PIJE_141$ht)
h_142 <- mean(laguna_pre_PIJE_142$ht)
h_143 <- mean(laguna_pre_PIJE_143$ht)
h_144 <- mean(laguna_pre_PIJE_144$ht)
h_170 <- mean(laguna_pre_PIJE_170$ht)
h_171 <- mean(laguna_pre_PIJE_171$ht)
h_172 <- mean(laguna_pre_PIJE_172$ht)
h_173 <- mean(laguna_pre_PIJE_173$ht)
h_175 <- mean(laguna_pre_PIJE_175$ht)
h_176 <- mean(laguna_pre_PIJE_176$ht)
h_177 <- mean(laguna_pre_PIJE_177$ht)
h_179 <- mean(laguna_pre_PIJE_179$ht)
h_180 <- mean(laguna_pre_PIJE_180$ht)
h_181 <- mean(laguna_pre_PIJE_181$ht)
h_195 <- mean(laguna_pre_PIJE_195$ht)
h_197 <- mean(laguna_pre_PIJE_197$ht)
h_198 <- mean(laguna_pre_PIJE_198$ht)
h_199 <- mean(laguna_pre_PIJE_199$ht)
h_200 <- mean(laguna_pre_PIJE_200$ht)

unique(laguna_pre_PIJE_clean$plot_id) # view plots with PIJE in laguna mtn.

# create data frame: project, year, plot_id, & abundance for PIJE
laguna_pre_PIJE_clean <- data.frame(
  project = rep("Laguna Mtn.", times = length(laguna_pre_PIJE_plots)), 
  species = rep("PIJE", times = length(laguna_pre_PIJE_plots)),
  plot_id = c(laguna_pre_PIJE_plots),
  abundance = c(l_p_128/plot_area, l_p_129/plot_area, l_p_130/plot_area, l_p_131/plot_area, l_p_132/plot_area, l_p_133/plot_area, l_p_134/plot_area, l_p_135/plot_area, l_p_137/plot_area, l_p_138/plot_area, l_p_139/plot_area, l_p_140/plot_area, l_p_141/plot_area, l_p_142/plot_area, l_p_143/plot_area, l_p_144/plot_area, l_p_170/plot_area, l_p_171/plot_area, l_p_172/plot_area, l_p_173/plot_area, l_p_175/plot_area, l_p_176/plot_area, l_p_177/plot_area, l_p_179/plot_area, l_p_180/plot_area, l_p_181/plot_area, l_p_195/plot_area, l_p_197/plot_area, l_p_198/plot_area, l_p_199/plot_area, l_p_200/plot_area),
  avg_ht = c(h_128, h_129, h_130, h_131, h_132, h_133, h_134, h_135, h_137, h_138, h_139, h_140, h_141, h_142, h_143, h_144, h_170, h_171, h_172, h_173, h_175, h_176, h_177, h_179, h_180, h_181, h_195, h_197, h_198, h_199, h_200),
  easting = c(552604, 552907, 552703, 552825, 552934, 552930, 552944, 553054, 552809, 552825, 552701, 552968, 552953, 552964, 552871, 552990, 553555, 553650, 553694, 553741, 553748, 553722, 553810, 553733, 553796, 553745, 553844, 553803, 553697, 553634, 553638),
  northing = c(3635674, 3635674, 3635674, 3635674, 3635625, 3635689, 3635441, 3635389, 3635340, 3635401, 3635401, 3635072, 3634891, 3636126, 3635065, 3635000, 3635917, 3635822, 3636045, 3636012, 3635916, 3635733, 3635775, 3635619, 3635629, 3635589, 3635701, 3635729, 3635950, 3635975, 3635910)
)

#### QUKE

laguna_pre_QUKE_plots <- unique(laguna_pre_QUKE$plot_id) # print each plot ID where QUKE is present

# create a data frame for each plot 
## NOTE: each plot is an 11.3m radius circular plot
laguna_pre_QUKE_128 <- filter(laguna_pre_QUKE, plot_id == "128")
laguna_pre_QUKE_129 <- filter(laguna_pre_QUKE, plot_id == "129")
laguna_pre_QUKE_130 <- filter(laguna_pre_QUKE, plot_id == "130")
laguna_pre_QUKE_131 <- filter(laguna_pre_QUKE, plot_id == "131")
laguna_pre_QUKE_133 <- filter(laguna_pre_QUKE, plot_id == "133")
laguna_pre_QUKE_134 <- filter(laguna_pre_QUKE, plot_id == "134")
laguna_pre_QUKE_135 <- filter(laguna_pre_QUKE, plot_id == "135")
laguna_pre_QUKE_137 <- filter(laguna_pre_QUKE, plot_id == "137")
laguna_pre_QUKE_138 <- filter(laguna_pre_QUKE, plot_id == "138")
laguna_pre_QUKE_139 <- filter(laguna_pre_QUKE, plot_id == "139")
laguna_pre_QUKE_140 <- filter(laguna_pre_QUKE, plot_id == "140")
laguna_pre_QUKE_141 <- filter(laguna_pre_QUKE, plot_id == "141")
laguna_pre_QUKE_142 <- filter(laguna_pre_QUKE, plot_id == "142")
laguna_pre_QUKE_143 <- filter(laguna_pre_QUKE, plot_id == "143")
laguna_pre_QUKE_144 <- filter(laguna_pre_QUKE, plot_id == "144")
laguna_pre_QUKE_170 <- filter(laguna_pre_QUKE, plot_id == "170")
laguna_pre_QUKE_171 <- filter(laguna_pre_QUKE, plot_id == "171")
laguna_pre_QUKE_172 <- filter(laguna_pre_QUKE, plot_id == "172")
laguna_pre_QUKE_173 <- filter(laguna_pre_QUKE, plot_id == "173")
laguna_pre_QUKE_175 <- filter(laguna_pre_QUKE, plot_id == "175")
laguna_pre_QUKE_176 <- filter(laguna_pre_QUKE, plot_id == "176")
laguna_pre_QUKE_177 <- filter(laguna_pre_QUKE, plot_id == "177")
laguna_pre_QUKE_179 <- filter(laguna_pre_QUKE, plot_id == "179")
laguna_pre_QUKE_180 <- filter(laguna_pre_QUKE, plot_id == "180")
laguna_pre_QUKE_181 <- filter(laguna_pre_QUKE, plot_id == "181")
laguna_pre_QUKE_195 <- filter(laguna_pre_QUKE, plot_id == "195")
laguna_pre_QUKE_197 <- filter(laguna_pre_QUKE, plot_id == "197")
laguna_pre_QUKE_198 <- filter(laguna_pre_QUKE, plot_id == "198")
laguna_pre_QUKE_199 <- filter(laguna_pre_QUKE, plot_id == "199")
laguna_pre_QUKE_200 <- filter(laguna_pre_QUKE, plot_id == "200")

# calculate plot area
plot_area <- pi*(11.35^2)
## plot area = 401.15m^2

# create vectors of the sum of each species' area per plot
l_q_128 <- sum(laguna_pre_QUKE_128$tree_area)
l_q_129 <- sum(laguna_pre_QUKE_129$tree_area)
l_q_130 <- sum(laguna_pre_QUKE_130$tree_area)
l_q_131 <- sum(laguna_pre_QUKE_131$tree_area)
l_q_133 <- sum(laguna_pre_QUKE_133$tree_area)
l_q_134 <- sum(laguna_pre_QUKE_134$tree_area)
l_q_135 <- sum(laguna_pre_QUKE_135$tree_area)
l_q_137 <- sum(laguna_pre_QUKE_137$tree_area)
l_q_138 <- sum(laguna_pre_QUKE_138$tree_area)
l_q_139 <- sum(laguna_pre_QUKE_139$tree_area)
l_q_140 <- sum(laguna_pre_QUKE_140$tree_area)
l_q_141 <- sum(laguna_pre_QUKE_141$tree_area)
l_q_142 <- sum(laguna_pre_QUKE_142$tree_area)
l_q_143 <- sum(laguna_pre_QUKE_143$tree_area)
l_q_144 <- sum(laguna_pre_QUKE_144$tree_area)
l_q_170 <- sum(laguna_pre_QUKE_170$tree_area)
l_q_171 <- sum(laguna_pre_QUKE_171$tree_area)
l_q_172 <- sum(laguna_pre_QUKE_172$tree_area)
l_q_173 <- sum(laguna_pre_QUKE_173$tree_area)
l_q_175 <- sum(laguna_pre_QUKE_175$tree_area)
l_q_176 <- sum(laguna_pre_QUKE_176$tree_area)
l_q_177 <- sum(laguna_pre_QUKE_177$tree_area)
l_q_179 <- sum(laguna_pre_QUKE_179$tree_area)
l_q_180 <- sum(laguna_pre_QUKE_180$tree_area)
l_q_181 <- sum(laguna_pre_QUKE_181$tree_area)
l_q_195 <- sum(laguna_pre_QUKE_195$tree_area)
l_q_197 <- sum(laguna_pre_QUKE_197$tree_area)
l_q_198 <- sum(laguna_pre_QUKE_198$tree_area)
l_q_199 <- sum(laguna_pre_QUKE_199$tree_area)
l_q_200 <- sum(laguna_pre_QUKE_200$tree_area)

# create vectors of the average height of each species per plot
h_q_128 <- mean(laguna_pre_QUKE_128$ht)
h_q_129 <- mean(laguna_pre_QUKE_129$ht)
h_q_130 <- mean(laguna_pre_QUKE_130$ht)
h_q_131 <- mean(laguna_pre_QUKE_131$ht)
h_q_133 <- mean(laguna_pre_QUKE_133$ht)
h_q_134 <- mean(laguna_pre_QUKE_134$ht)
h_q_135 <- mean(laguna_pre_QUKE_135$ht)
h_q_137 <- mean(laguna_pre_QUKE_137$ht)
h_q_138 <- mean(laguna_pre_QUKE_138$ht)
h_q_139 <- mean(laguna_pre_QUKE_139$ht)
h_q_140 <- mean(laguna_pre_QUKE_140$ht)
h_q_141 <- mean(laguna_pre_QUKE_141$ht)
h_q_142 <- mean(laguna_pre_QUKE_142$ht)
h_q_143 <- mean(laguna_pre_QUKE_143$ht)
h_q_144 <- mean(laguna_pre_QUKE_144$ht)
h_q_170 <- mean(laguna_pre_QUKE_170$ht)
h_q_171 <- mean(laguna_pre_QUKE_171$ht)
h_q_172 <- mean(laguna_pre_QUKE_172$ht)
h_q_173 <- mean(laguna_pre_QUKE_173$ht)
h_q_175 <- mean(laguna_pre_QUKE_175$ht)
h_q_176 <- mean(laguna_pre_QUKE_176$ht)
h_q_177 <- mean(laguna_pre_QUKE_177$ht)
h_q_179 <- mean(laguna_pre_QUKE_179$ht)
h_q_180 <- mean(laguna_pre_QUKE_180$ht)
h_q_181 <- mean(laguna_pre_QUKE_181$ht)
h_q_195 <- mean(laguna_pre_QUKE_195$ht)
h_q_197 <- mean(laguna_pre_QUKE_197$ht)
h_q_198 <- mean(laguna_pre_QUKE_198$ht)
h_q_199 <- mean(laguna_pre_QUKE_199$ht)
h_q_200 <- mean(laguna_pre_QUKE_200$ht)

unique(laguna_pre_QUKE_clean$plot_id)

# create data frame: project, year, plot_id, & abundance for QUKE
laguna_pre_QUKE_clean <- data.frame(
  project = rep("Laguna Mtn.", times = length(laguna_pre_QUKE_plots)), 
  species = rep("QUKE", times = length(laguna_pre_QUKE_plots)),
  plot_id = c(laguna_pre_QUKE_plots),
  abundance = c(l_q_128/plot_area, l_q_129/plot_area, l_q_130/plot_area, l_q_131/plot_area, l_q_133/plot_area, l_q_134/plot_area, l_q_135/plot_area, l_q_137/plot_area, l_q_138/plot_area, l_q_139/plot_area, l_q_140/plot_area, l_q_141/plot_area, l_q_142/plot_area, l_q_143/plot_area, l_q_144/plot_area, l_q_170/plot_area, l_q_171/plot_area, l_q_172/plot_area, l_q_173/plot_area, l_q_175/plot_area, l_q_176/plot_area, l_q_177/plot_area, l_q_179/plot_area, l_q_180/plot_area, l_q_181/plot_area, l_q_195/plot_area, l_q_197/plot_area, l_q_198/plot_area, l_q_199/plot_area, l_q_200/plot_area),
  avg_ht = c(h_q_128, h_q_129, h_q_130, h_q_131, h_q_133, h_q_134, h_q_135, h_q_137, h_q_138, h_q_139, h_q_140, h_q_141, h_q_142, h_q_143, h_q_144, h_q_170, h_q_171, h_q_172, h_q_173, h_q_175, h_q_176, h_q_177, h_q_179, h_q_180, h_q_181, h_q_195, h_q_197, h_q_198, h_q_199, h_q_200),
  easting = c(552604, 552907, 552703, 552825, 552930, 552944, 553054, 552809, 552825, 552701, 552953, 552964, 552871, 552990, 553555, 553650, 553694, 553741, 553748, 553722, 553810, 553733, 553796, 553745, 553844, 553738, 553803, 553697, 553634, 553638),
  northing = c(3635674, 3635518, 3635561, 3635690, 3635689, 3635441, 3635389, 3635340, 3635401, 3635401, 3634891, 3636126, 3635065, 3635000, 3635917, 3635822, 3636045, 3636012, 3635916, 3635733, 3635775, 3635619, 3635629, 3635589, 3635701, 3635675, 3635729, 3635950, 3635975, 3635910)
)

l_abundance <- rbind(laguna_pre_PIJE_clean, laguna_pre_QUKE_clean)
```

#### bluff mesa abundance
```{r}
# repeat for bluff mesa
unique(bluffmesa_pre$species) # identify species present in bluff mesa fire data

bluffmesa_pre_ABCO <- filter(bluffmesa_pre, species == "ABCO") # create data frame w/ only ABCO sp.
bluffmesa_pre_PIJE <- filter(bluffmesa_pre, species == "PIJE") # create data frame w/ only PIJE sp.

#### ABCO

unique(bluffmesa_pre_ABCO$plot_id) # print each plot ID where ABCO is present

# create a data frame for each plot 
## NOTE: each plot is an 11.3m radius circular plot
bluffmesa_pre_ABCO_24 <- filter(bluffmesa_pre_ABCO, plot_id == "24")
bluffmesa_pre_ABCO_26 <- filter(bluffmesa_pre_ABCO, plot_id == "26")
bluffmesa_pre_ABCO_33 <- filter(bluffmesa_pre_ABCO, plot_id == "33")
bluffmesa_pre_ABCO_48 <- filter(bluffmesa_pre_ABCO, plot_id == "48")
bluffmesa_pre_ABCO_49 <- filter(bluffmesa_pre_ABCO, plot_id == "49")
bluffmesa_pre_ABCO_52 <- filter(bluffmesa_pre_ABCO, plot_id == "52")

# calculate plot area
plot_area <- pi*(11.35^2)
## plot area = 401.15m^2

# create data frame: project, year, plot_id, & abundance for ABCO
bluffmesa_pre_ABCO_clean <- data.frame(
  project = rep("Bluff Mesa", times = length(unique(bluffmesa_pre_ABCO$plot_id))), 
  species = rep("ABCO", times = length(unique(bluffmesa_pre_ABCO$plot_id))),
  plot_id = c(unique(bluffmesa_pre_ABCO$plot_id)),
  abundance = c(sum(bluffmesa_pre_ABCO_24$tree_area)/plot_area, sum(bluffmesa_pre_ABCO_26$tree_area)/plot_area, sum(bluffmesa_pre_ABCO_33$tree_area)/plot_area, sum(bluffmesa_pre_ABCO_48$tree_area)/plot_area, sum(bluffmesa_pre_ABCO_49$tree_area)/plot_area, sum(bluffmesa_pre_ABCO_52$tree_area)/plot_area),
  avg_ht = c(mean(bluffmesa_pre_ABCO_24$ht), mean(bluffmesa_pre_ABCO_26$ht), mean(bluffmesa_pre_ABCO_33$ht), mean(bluffmesa_pre_ABCO_48$ht), mean(bluffmesa_pre_ABCO_49$ht), mean(bluffmesa_pre_ABCO_52$ht)),
  easting = c(502045, 502155, 502518, 502663, 502600, 503370),
  northing = c(3786845, 3786746, 3786610, 3787038, 3787201, 3786975)
) # note --> no abundance data for plot 26 because there is no dbh data

#### PIJE

unique(bluffmesa_pre_PIJE$plot_id) # print each plot ID where PIJE is present

# create a data frame for each plot 
## NOTE: each plot is an 11.3m radius circular plot
bluffmesa_pre_PIJE_24 <- filter(bluffmesa_pre_PIJE, plot_id == "24")
bluffmesa_pre_PIJE_25 <- filter(bluffmesa_pre_PIJE, plot_id == "25")
bluffmesa_pre_PIJE_26 <- filter(bluffmesa_pre_PIJE, plot_id == "26")
bluffmesa_pre_PIJE_27 <- filter(bluffmesa_pre_PIJE, plot_id == "27")
bluffmesa_pre_PIJE_33 <- filter(bluffmesa_pre_PIJE, plot_id == "33")
bluffmesa_pre_PIJE_49 <- filter(bluffmesa_pre_PIJE, plot_id == "49")
bluffmesa_pre_PIJE_50 <- filter(bluffmesa_pre_PIJE, plot_id == "50")
bluffmesa_pre_PIJE_51 <- filter(bluffmesa_pre_PIJE, plot_id == "51")
bluffmesa_pre_PIJE_52 <- filter(bluffmesa_pre_PIJE, plot_id == "52")
bluffmesa_pre_PIJE_53 <- filter(bluffmesa_pre_PIJE, plot_id == "53")

# create data frame: project, year, plot_id, & abundance for PIJE
bluffmesa_pre_PIJE_clean <- data.frame(
  project = rep("Bluff Mesa", times = length(unique(bluffmesa_pre_PIJE$plot_id))), 
  species = rep("PIJE", times = length(unique(bluffmesa_pre_PIJE$plot_id))),
  plot_id = c(unique(bluffmesa_pre_PIJE$plot_id)),
  abundance = c(sum(bluffmesa_pre_PIJE_24$tree_area)/plot_area, sum(bluffmesa_pre_PIJE_25$tree_area)/plot_area, sum(bluffmesa_pre_PIJE_26$tree_area)/plot_area, sum(bluffmesa_pre_PIJE_27$tree_area)/plot_area, sum(bluffmesa_pre_PIJE_33$tree_area)/plot_area, sum(bluffmesa_pre_PIJE_49$tree_area)/plot_area, sum(bluffmesa_pre_PIJE_50$tree_area)/plot_area, sum(bluffmesa_pre_PIJE_51$tree_area)/plot_area, sum(bluffmesa_pre_PIJE_52$tree_area)/plot_area, sum(bluffmesa_pre_PIJE_53$tree_area)/plot_area),
  avg_ht = c(mean(bluffmesa_pre_PIJE_24$ht), mean(bluffmesa_pre_PIJE_25$ht), mean(bluffmesa_pre_PIJE_26$ht), mean(bluffmesa_pre_PIJE_27$ht), mean(bluffmesa_pre_PIJE_33$ht), mean(bluffmesa_pre_PIJE_49$ht), mean(bluffmesa_pre_PIJE_50$ht), mean(bluffmesa_pre_PIJE_51$ht), mean(bluffmesa_pre_PIJE_52$ht), mean(bluffmesa_pre_PIJE_53$ht)),
  easting = c(502045, 502018, 502155, 502360, 502518, 502600, 502811, 503248, 503370, 502980),
  northing = c(3786845, 3786660, 3786746, 3786721, 3786610, 3787201, 3787146, 3787101, 3786975, 3787237)
)

# combine all pre-fire data from bluff mesa plots
bm_abundance <- rbind(bluffmesa_pre_PIJE_clean, bluffmesa_pre_ABCO_clean)
```

#### thomas fire abundance
```{r}
# plot size: 11.35 m radius (405 m^2)
unique(thomas_post$species) # identify species present in bluff mesa fire data

thomas_post_PIPO <- filter(thomas_post, species == "PIPO") # create data frame w/ only PIPO sp.
thomas_post_QUWI <- filter(thomas_post, species == "QUWI") # create data frame w/ only QUWI sp.
thomas_post_QUCH <- filter(thomas_post, species == "QUCH") # create data frame w/ only QUCH sp.
thomas_post_PSMA <- filter(thomas_post, species == "PSMA") # create data frame w/ only PSMA sp.
thomas_post_UMCA <- filter(thomas_post, species == "UMCA") # create data frame w/ only UMCA sp.

#### PIPO

unique(thomas_post_PIPO$plot_id) # print each plot ID where PIPO is present

# create a data frame for each plot 
## NOTE: each plot is an 11.3m radius circular plot
thomas_post_PIPO_1 <- filter(thomas_post_PIPO, plot_id == "PIPO-1")
thomas_post_PIPO_2 <- filter(thomas_post_PIPO, plot_id == "PIPO-2")
thomas_post_PIPO_3 <- filter(thomas_post_PIPO, plot_id == "PIPO-3")

# calculate plot area
plot_area <- pi*(11.35^2)
## plot area = 405 m^2

# create data frame: project, year, plot_id, & abundance for PIPO
thomas_post_PIPO_clean <- data.frame(
  project = rep("Thomas", times = length(unique(thomas_post_PIPO$plot_id))), 
  species = rep("PIPO", times = length(unique(thomas_post_PIPO$plot_id))),
  plot_id = c(unique(thomas_post_PIPO$plot_id)),
  abundance = c(sum(thomas_post_PIPO_1$tree_area)/plot_area, sum(thomas_post_PIPO_2$tree_area)/plot_area, sum(thomas_post_PIPO_3$tree_area)/plot_area),
  avg_ht = c(mean(thomas_post_PIPO_1$ht), mean(thomas_post_PIPO_2$ht), mean(thomas_post_PIPO_3$ht)),
  easting = c(292063, 291414, 291304),
  northing = c(3824903, 3824672, 3824663)
)

#### QUWI

unique(thomas_post_QUWI$plot_id) # print each plot ID where QUWI is present

# create a data frame for each plot 
## NOTE: each plot is an 11.3m radius circular plot
thomas_post_QUWI_1 <- filter(thomas_post_QUWI, plot_id == "PIPO-2")
thomas_post_QUWI_2 <- filter(thomas_post_QUWI, plot_id == "BC12")

# calculate plot area
plot_area <- pi*(11.35^2)
## plot area = 405 m^2

# create data frame: project, year, plot_id, & abundance for QUWI
thomas_post_QUWI_clean <- data.frame(
  project = rep("Thomas", times = length(unique(thomas_post_QUWI$plot_id))), 
  species = rep("QUWI", times = length(unique(thomas_post_QUWI$plot_id))),
  plot_id = c(unique(thomas_post_QUWI$plot_id)),
  abundance = c(sum(thomas_post_QUWI_1$tree_area)/plot_area, sum(thomas_post_QUWI_2$tree_area)/plot_area),
  avg_ht = c(mean(thomas_post_QUWI_1$ht), mean(thomas_post_QUWI_2$ht)),
  easting = c(291414, 270783),
  northing = c(3824672, 3818567)
)

#### QUCH

unique(thomas_post_QUCH$plot_id) # print each plot ID where QUCH is present

# create a data frame for each plot 
## NOTE: each plot is an 11.35m radius circular plot
thomas_post_QUCH_1 <- filter(thomas_post_QUCH, plot_id == "BC1")
thomas_post_QUCH_2 <- filter(thomas_post_QUCH, plot_id == "BC10")
thomas_post_QUCH_3 <- filter(thomas_post_QUCH, plot_id == "BC11")
thomas_post_QUCH_4 <- filter(thomas_post_QUCH, plot_id == "BC12")
thomas_post_QUCH_5 <- filter(thomas_post_QUCH, plot_id == "BC2")
thomas_post_QUCH_6 <- filter(thomas_post_QUCH, plot_id == "BC3")
thomas_post_QUCH_7 <- filter(thomas_post_QUCH, plot_id == "BC4")
thomas_post_QUCH_8 <- filter(thomas_post_QUCH, plot_id == "BC5")
thomas_post_QUCH_9 <- filter(thomas_post_QUCH, plot_id == "BC6")
thomas_post_QUCH_10 <- filter(thomas_post_QUCH, plot_id == "BC7")

# calculate plot area
plot_area <- pi*(11.35^2)
## plot area = 405 m^2

# create data frame: project, year, plot_id, & abundance for QUCH
thomas_post_QUCH_clean <- data.frame(
  project = rep("Thomas", times = length(unique(thomas_post_QUCH$plot_id))), 
  species = rep("QUCH", times = length(unique(thomas_post_QUCH$plot_id))),
  plot_id = c(unique(thomas_post_QUCH$plot_id)),
  abundance = c(sum(thomas_post_QUCH_1$tree_area)/plot_area, sum(thomas_post_QUCH_2$tree_area)/plot_area, sum(thomas_post_QUCH_3$tree_area)/plot_area, sum(thomas_post_QUCH_4$tree_area)/plot_area, sum(thomas_post_QUCH_5$tree_area)/plot_area, sum(thomas_post_QUCH_6$tree_area)/plot_area, sum(thomas_post_QUCH_7$tree_area)/plot_area, sum(thomas_post_QUCH_8$tree_area)/plot_area, sum(thomas_post_QUCH_9$tree_area)/plot_area, sum(thomas_post_QUCH_10$tree_area)/plot_area),
  avg_ht = c(mean(thomas_post_QUCH_1$ht), mean(thomas_post_QUCH_2$ht), mean(thomas_post_QUCH_3$ht), mean(thomas_post_QUCH_4$ht), mean(thomas_post_QUCH_5$ht), mean(thomas_post_QUCH_6$ht), mean(thomas_post_QUCH_7$ht), mean(thomas_post_QUCH_8$ht), mean(thomas_post_QUCH_9$ht), mean(thomas_post_QUCH_10$ht)),
  easting = c(298424, 292126, 291790, 270783, 298262, 298407, 298752, 299952, 300114, 298189),
  northing = c(3822263, 3825085, 3824989, 3818567, 3822354, 3822698, 3821985, 3821912, 3821966, 3822595)
)

#### PSMA

unique(thomas_post_PSMA$plot_id) # print each plot ID where PSMA is present

# create a data frame for each plot 
## NOTE: each plot is an 11.35m radius circular plot
thomas_post_PSMA_1 <- filter(thomas_post_PSMA, plot_id == "BC1")
thomas_post_PSMA_2 <- filter(thomas_post_PSMA, plot_id == "BC10")
thomas_post_PSMA_3 <- filter(thomas_post_PSMA, plot_id == "BC11")
thomas_post_PSMA_4 <- filter(thomas_post_PSMA, plot_id == "BC12")
thomas_post_PSMA_5 <- filter(thomas_post_PSMA, plot_id == "BC2")
thomas_post_PSMA_6 <- filter(thomas_post_PSMA, plot_id == "BC3")
thomas_post_PSMA_7 <- filter(thomas_post_PSMA, plot_id == "BC4")
thomas_post_PSMA_8 <- filter(thomas_post_PSMA, plot_id == "BC5")
thomas_post_PSMA_9 <- filter(thomas_post_PSMA, plot_id == "BC6")
thomas_post_PSMA_10 <- filter(thomas_post_PSMA, plot_id == "BC7")
thomas_post_PSMA_11 <- filter(thomas_post_PSMA, plot_id == "BC8")
thomas_post_PSMA_12 <- filter(thomas_post_PSMA, plot_id == "BC9")

# calculate plot area
plot_area <- pi*(11.35^2)
## plot area = 405 m^2

# create data frame: project, year, plot_id, & abundance for PSMA
thomas_post_PSMA_clean <- data.frame(
  project = rep("Thomas", times = length(unique(thomas_post_PSMA$plot_id))), 
  species = rep("PSMA", times = length(unique(thomas_post_PSMA$plot_id))),
  plot_id = c(unique(thomas_post_PSMA$plot_id)),
  abundance = c(sum(thomas_post_PSMA_1$tree_area)/plot_area, sum(thomas_post_PSMA_2$tree_area)/plot_area, sum(thomas_post_PSMA_3$tree_area)/plot_area, sum(thomas_post_PSMA_4$tree_area)/plot_area, sum(thomas_post_PSMA_5$tree_area)/plot_area, sum(thomas_post_PSMA_6$tree_area)/plot_area, sum(thomas_post_PSMA_7$tree_area)/plot_area, sum(thomas_post_PSMA_8$tree_area)/plot_area, sum(thomas_post_PSMA_9$tree_area)/plot_area, sum(thomas_post_PSMA_10$tree_area)/plot_area, sum(thomas_post_PSMA_11$tree_area)/plot_area, sum(thomas_post_PSMA_12$tree_area)/plot_area),
  avg_ht = c(mean(thomas_post_PSMA_1$ht), mean(thomas_post_PSMA_2$ht), mean(thomas_post_PSMA_3$ht), mean(thomas_post_PSMA_4$ht), mean(thomas_post_PSMA_5$ht), mean(thomas_post_PSMA_6$ht), mean(thomas_post_PSMA_7$ht), mean(thomas_post_PSMA_8$ht), mean(thomas_post_PSMA_9$ht), mean(thomas_post_PSMA_10$ht), mean(thomas_post_PSMA_11$ht), mean(thomas_post_PSMA_12$ht)),
  easting = c(298424, 292126, 291790, 270783, 298262, 298407, 298752, 299952, 300114, 298189, 300302, 292336),
  northing = c(3822263, 3825085, 3824989, 3818567, 3822354, 3822698, 3821985, 3821912, 3821966, 3822595, 3823239, 3825104)
)

#### UMCA

unique(thomas_post_UMCA$plot_id) # print each plot ID where UMCA is present

# create a data frame for each plot 
## NOTE: each plot is an 11.35m radius circular plot
thomas_post_UMCA_1 <- filter(thomas_post_UMCA, plot_id == "BC12")

# calculate plot area
plot_area <- pi*(11.35^2)
## plot area = 405 m^2

# create data frame: project, year, plot_id, & abundance for UMCA
thomas_post_UMCA_clean <- data.frame(
  project = rep("Thomas", times = length(unique(thomas_post_UMCA$plot_id))), 
  species = rep("UMCA", times = length(unique(thomas_post_UMCA$plot_id))),
  plot_id = c(unique(thomas_post_UMCA$plot_id)),
  abundance = c(sum(thomas_post_UMCA_1$tree_area)/plot_area),
  avg_ht = c(mean(thomas_post_UMCA_1$ht)),
  easting = c(270783),
  northing = c(3818567)
)

# combine all pre-fire data from thomas fire plots
tf_abundance <- rbind(thomas_post_PIPO_clean, thomas_post_PSMA_clean, thomas_post_QUCH_clean, thomas_post_QUWI_clean, thomas_post_UMCA_clean)
```

#### combine all abundance data
```{r}
abundance_whole <- rbind(l_abundance, bm_abundance, tf_abundance)
# note: BM 26 ABCO = NA b/c no dbh data recorded

# export to csv
write.csv(abundance_whole, "data/Nicole/abundance_whole.csv", row.names=FALSE)
```

### fuels data
```{r}
# load in laguna mountain fuels data
lm_fuels <- read.csv("data/Nicole/laguna/LM_coordinates.csv") %>%
  as.data.frame() %>%
  clean_names() %>%
  filter(plot_id > 127) %>%
  filter(plot_id < 201) %>%
  select(site_year, plot_id, easting, northing, fuel_loading_tons_per_acre, x_19, x_20, x_21, x_22, x_23, fuel_height_in, x_24, x_25, x_26, distance_to_crown_ft) %>%
  rename(fine_fuels = fuel_loading_tons_per_acre, hr_1 = x_19, hr_10 = x_20, hr_100 = x_21, cwd = x_22, total = x_23, duff = fuel_height_in, litter = x_24, duff_litter = x_25, fuel = x_26) %>%
  mutate(fine_fuels = as.numeric(fine_fuels)) %>%
  mutate(hr_1 = as.numeric(hr_1)) %>%
  mutate(hr_10 = as.numeric(hr_10)) %>%
  mutate(hr_100 = as.numeric(hr_100)) %>%
  mutate(duff_litter = as.numeric(duff_litter)) %>%
  mutate(distance_to_crown_ft = as.numeric(distance_to_crown_ft)) %>%
  mutate(total = as.numeric(total)) %>%
  mutate(plot_id = as.character(plot_id)) %>%
  na_if("") %>%
  na_if("N/A") %>%
  slice_head(n = 30)

# load in bluff mesa fuels data
bm_fuels <- read.csv("data/Nicole/bluffmesa/BM_coordinates.csv") %>%
  clean_names() %>%
  filter(plot_id > 23) %>%
  filter(plot_id < 54) %>%
  select(site_year, plot_id, easting, northing, fuels_tons_per_acre, x_16, x_17, x_18, x_19, fuel_height_in, x_20, distance_to_crown_ft) %>%
  rename(hr_1 = fuels_tons_per_acre, hr_10 = x_16, hr_100 = x_17, cwd = x_18, total = x_19, duff_litter = fuel_height_in, fuel = x_20) %>%
  mutate(fine_fuels = rep("NA", length = 40)) %>%
  mutate(duff = rep("NA", length = 40)) %>%
  mutate(litter = rep("NA", length = 40)) %>%
  na_if("NA")

# load in thomas fire fuels data
tf_fuels <- read.csv("data/Nicole/thomas/TF_coord.csv") %>%
  clean_names() %>%
  slice(-(1)) %>%
  select(site_year, plot_id, easting, northing, fuels_tons_per_acre, x_16, x_17, x_18, x_19, fuel_height_in, x_20, distance_to_crown_ft) %>%
  rename(hr_1 = fuels_tons_per_acre, hr_10 = x_16, hr_100 = x_17, cwd = x_18, total = x_19, duff_litter = fuel_height_in, fuel = x_20) %>%
  mutate(fine_fuels = rep("NA", length = 15)) %>%
  mutate(duff = rep("NA", length = 15)) %>%
  mutate(litter = rep("NA", length = 15)) %>%
  na_if("NA") %>%
  na_if("n/a")

fuels_whole <- rbind(
  lm_fuels, bm_fuels, tf_fuels
)

# export as csv
write.csv(fuels_whole, "data/Nicole/fuels_whole.csv", row.names=FALSE)
```

### post-fire data
#### laguna mountain post-fire
```{r}
# load in raw post-fire laguna mountain data (2021 & 2022)
lm_128_2021_trees <- read.csv("data/Nicole/laguna/lagunamtn-post/LM_128_2021_trees.csv") %>%
  mutate(plot_id = rep(128, length = 8))
lm_129_2021_trees <- read.csv("data/Nicole/laguna/lagunamtn-post/LM_129_2021_trees.csv") %>%
  mutate(plot_id = rep(129, length = 12))
lm_130_2021_trees <- read.csv("data/Nicole/laguna/lagunamtn-post/LM_130_2021_trees.csv") %>%
  mutate(plot_id = rep(130, length = 12))
lm_131_2021_trees <- read.csv("data/Nicole/laguna/lagunamtn-post/LM_131_2021_trees.csv") %>%
  mutate(plot_id = rep(131, length = 7))
lm_132_2021_trees <- read.csv("data/Nicole/laguna/lagunamtn-post/LM_132_2021_trees.csv") %>%
  mutate(plot_id = rep(132, length = 3))
lm_133_2021_trees <- read.csv("data/Nicole/laguna/lagunamtn-post/LM_133_2021_trees.csv") %>%
  mutate(plot_id = rep(133, length = 6))
lm_134_2021_trees <- read.csv("data/Nicole/laguna/lagunamtn-post/LM_134_2021_trees.csv") %>%
  mutate(plot_id = rep(134, length = 10))
lm_135_2021_trees <- read.csv("data/Nicole/laguna/lagunamtn-post/LM_135_2021_trees.csv") %>%
  mutate(plot_id = rep(135, length = 6))
lm_137_2021_trees <- read.csv("data/Nicole/laguna/lagunamtn-post/LM_137_2021_trees.csv") %>%
  mutate(plot_id = rep(137, length = 7))
lm_138_2021_trees <- read.csv("data/Nicole/laguna/lagunamtn-post/LM_138_2021_trees.csv") %>%
  mutate(plot_id = rep(138, length = 7))
lm_139_2021_trees <- read.csv("data/Nicole/laguna/lagunamtn-post/LM_139_2021_trees.csv") %>%
  mutate(plot_id = rep(139, length = 6))
lm_140_2021_trees <- read.csv("data/Nicole/laguna/lagunamtn-post/LM_140_2021_trees.csv") %>%
  mutate(plot_id = rep(140, length = 7))
lm_141_2021_trees <- read.csv("data/Nicole/laguna/lagunamtn-post/LM_141_2021_trees.csv") %>%
  mutate(plot_id = rep(141, length = 8))
lm_142_2021_trees <- read.csv("data/Nicole/laguna/lagunamtn-post/LM_142_2021_trees.csv") %>%
  mutate(plot_id = rep(142, length = 8))
lm_143_2021_trees <- read.csv("data/Nicole/laguna/lagunamtn-post/LM_143_2021_trees.csv") %>%
  mutate(plot_id = rep(143, length = 10))
lm_144_2021_trees <- read.csv("data/Nicole/laguna/lagunamtn-post/LM_144_2021_trees.csv") %>%
  mutate(plot_id = rep(144, length = 6))
lm_145_2021_trees <- read.csv("data/Nicole/laguna/lagunamtn-post/LM_145_2021_trees.csv") %>%
  mutate(plot_id = rep(145, length = 12))
lm_170_2022_trees <- read.csv("data/Nicole/laguna/lagunamtn-post/LM_170_2022_trees.csv") %>%
  mutate(plot_id = rep(170, length = 7))
lm_171_2022_trees <- read.csv("data/Nicole/laguna/lagunamtn-post/LM_171_2022_trees.csv") %>%
  mutate(plot_id = rep(171, length = 8))
lm_172_2022_trees <- read.csv("data/Nicole/laguna/lagunamtn-post/LM_172_2022_trees.csv") %>%
  mutate(plot_id = rep(172, length = 9))
lm_173_2022_trees <- read.csv("data/Nicole/laguna/lagunamtn-post/LM_173_2022_trees.csv") %>%
  mutate(plot_id = rep(173, length = 15))
lm_175_2022_trees <- read.csv("data/Nicole/laguna/lagunamtn-post/LM_175_2022_trees.csv") %>%
  mutate(plot_id = rep(175, length = 8))
lm_176_2022_trees <- read.csv("data/Nicole/laguna/lagunamtn-post/LM_176_2022_trees.csv") %>%
  mutate(plot_id = rep(176, length = 7))
lm_177_2022_trees <- read.csv("data/Nicole/laguna/lagunamtn-post/LM_177_2022_trees.csv") %>%
  mutate(plot_id = rep(177, length = 7))
lm_179_2022_trees <- read.csv("data/Nicole/laguna/lagunamtn-post/LM_179_2022_trees.csv") %>%
  mutate(plot_id = rep(179, length = 6))
lm_180_2022_trees <- read.csv("data/Nicole/laguna/lagunamtn-post/LM_180_2022_trees.csv") %>%
  mutate(plot_id = rep(180, length = 17))
lm_181_2022_trees <- read.csv("data/Nicole/laguna/lagunamtn-post/LM_181_2022_trees.csv") %>%
  mutate(plot_id = rep(181, length = 19))
lm_195_2022_trees <- read.csv("data/Nicole/laguna/lagunamtn-post/LM_195_2022_trees.csv") %>%
  mutate(plot_id = rep(195, length = 25))
lm_196_2022_trees <- read.csv("data/Nicole/laguna/lagunamtn-post/LM_196_2022_trees.csv") %>%
  mutate(plot_id = rep(196, length = 8))
lm_197_2022_trees <- read.csv("data/Nicole/laguna/lagunamtn-post/LM_197_2022_trees.csv") %>%
  mutate(plot_id = rep(197, length = 5))
lm_198_2022_trees <- read.csv("data/Nicole/laguna/lagunamtn-post/LM_198_2022_trees.csv") %>%
  mutate(plot_id = rep(198, length = 7))
lm_199_2022_trees <- read.csv("data/Nicole/laguna/lagunamtn-post/LM_199_2022_trees.csv") %>%
  mutate(plot_id = rep(199, length = 12))
lm_200_2022_trees <- read.csv("data/Nicole/laguna/lagunamtn-post/LM_200_2022_trees.csv") %>%
  mutate(plot_id = rep(200, length = 11))

laguna_post <- rbind(
  lm_128_2021_trees, lm_129_2021_trees, lm_130_2021_trees, lm_132_2021_trees, lm_133_2021_trees, lm_134_2021_trees, lm_135_2021_trees, lm_137_2021_trees, lm_138_2021_trees, lm_139_2021_trees, lm_140_2021_trees, lm_141_2021_trees, lm_142_2021_trees, lm_143_2021_trees, lm_144_2021_trees, lm_145_2021_trees, lm_170_2022_trees, lm_171_2022_trees, lm_172_2022_trees, lm_173_2022_trees, lm_175_2022_trees, lm_176_2022_trees, lm_177_2022_trees, lm_179_2022_trees, lm_180_2022_trees, lm_181_2022_trees, lm_195_2022_trees, lm_196_2022_trees, lm_197_2022_trees, lm_198_2022_trees, lm_199_2022_trees, lm_200_2022_trees
) %>%
  clean_names() %>%
  mutate(location = rep("Laguna Mountain", length = 299)) %>%
  mutate(tree_area = ((pi*(laguna_post$dbh^2)/4)/100)) %>%
  select(location, plot_id, tag_no, status, dbh, ht, crwn_rto, crwn_rad, char_ht, scorch_ht, cr_sc_pct, uv1, uv2, uv3, species, tree_area)
```

#### bluff mesa post-fire
```{r}
# load in raw post-fire bluff mesa data (2021)
bm_24_2021_trees <- read.csv("data/Nicole/bluffmesa/BM_24_2021_trees.csv") %>%
  mutate(plot_id = rep(24, length = 8))
bm_25_2021_trees <- read.csv("data/Nicole/bluffmesa/BM_25_2021_trees.csv") %>%
  mutate(plot_id = rep(25, length = 4))
bm_26_2021_trees <- read.csv("data/Nicole/bluffmesa/BM_26_2021_trees.csv") %>%
  mutate(plot_id = rep(26, length = 3))
bm_27_2021_trees <- read.csv("data/Nicole/bluffmesa/BM_27_2021_trees.csv") %>%
  mutate(plot_id = rep(27, length = 3))
bm_33_2021_trees <- read.csv("data/Nicole/bluffmesa/BM_33_2021_trees.csv") %>%
  mutate(plot_id = rep(33, length = 4))
bm_48_2021_trees <- read.csv("data/Nicole/bluffmesa/BM_48_2021_trees.csv") %>%
  mutate(plot_id = rep(48, length = 6))
bm_49_2021_trees <- read.csv("data/Nicole/bluffmesa/BM_49_2021_trees.csv") %>%
  mutate(plot_id = rep(49, length = 10))
bm_50_2021_trees <- read.csv("data/Nicole/bluffmesa/BM_50_2021_trees.csv") %>%
  mutate(plot_id = rep(50, length = 4))
bm_51_2021_trees <- read.csv("data/Nicole/bluffmesa/BM_51_2021_trees.csv") %>%
  mutate(plot_id = rep(51, length = 4))
bm_52_2021_trees <- read.csv("data/Nicole/bluffmesa/BM_52_2021_trees.csv") %>%
  mutate(plot_id = rep(52, length = 3))
bm_53_2021_trees <- read.csv("data/Nicole/bluffmesa/BM_53_2021_trees.csv") %>%
  mutate(plot_id = rep(53, length = 5))

# combine raw pre-fire bluff mesa data into one data frame
bluffmesa_post <- rbind(
  bm_24_2021_trees, bm_25_2021_trees, bm_26_2021_trees, bm_27_2021_trees, bm_33_2021_trees, bm_48_2021_trees, bm_49_2021_trees, bm_50_2021_trees, bm_51_2021_trees, bm_52_2021_trees, bm_53_2021_trees) %>%
  clean_names() %>%
  mutate(location = rep("Bluff Mesa", length = 54)) %>%
  mutate(tree_area = ((pi*(bluffmesa_post$dbh^2)/4)/100)) %>%
  select(location, plot_id, tag_no, status, dbh, ht, crwn_rto, crwn_rad, char_ht, scorch_ht, cr_sc_pct, uv1, uv2, uv3, species, tree_area)

# create 1 data frame for all post-fire data
postfire_whole <- rbind(
  laguna_post, bluffmesa_post
) %>%
  mutate(category = rep("post", length = 353))
```

```{r}
# combine pre-fire and post-fire data into one dataframe
pre_post_whole <- rbind(
  prefire_whole, postfire_whole, thomas_post
)

# export to csv
write.csv(pre_post_whole, "data/Nicole/pre_post_whole.csv", row.names=FALSE)
```

### leaf trait data
#### leaf area
```{r}
# determine the species present in the pre/post fire data
laguna_species <- unique(laguna_pre$species) # create list of all species present in laguna fire data
bluffmesa_species <- unique(bluffmesa_pre$species) # create list of all species present in bluff mesa fire data
 
# read in data from TRY database
leaf_area <- read.csv("data/Veg-data/leaf_area.csv") %>%
  clean_names() %>%
  select(dataset_id, dataset, species_name, trait_id, trait_name, data_name, orig_value_str, orig_unit_str, std_value) %>%
  slice_head(n = 65)

# calculate community weighted mean (trait value x species abundance)
## laguna mountain
laguna_plots <- unique(laguna_pre$plot_id) %>% # list all of the plots included in the laguna mountain burn area
  as.character()
leaf_area_QUCH <- leaf_area %>% # subset leaf area data to only include QUCH
  filter(leaf_area$species_name == "Quercus chapmanii")
leaf_area_QUKE <- leaf_area %>% # subset leaf area data to only include QUKE
  filter(leaf_area$species_name == "Quercus keloggii")
leaf_area_ABCO <- leaf_area %>% # subset leaf area data to only include ABCO
  filter(leaf_area$species_name == "Abies concolor")

## bluff mesa
bluffmesa_plots <- unique(bluffmesa_pre$plot_id) %>% # list all of the plots included in the bluff mesa burn area
  as.character()
```

### building bar plots
#### laguna mountain leaf area
```{r}
### leaf area
## laguna mountain
# calculate QUCH mean leaf area
QUCH_leaf_area <- (15.76 + 14.76 + 28.2 + 18.57 + 14.29 + 21.47 + 24.14 + 17 + 9.53 + 15.16 + 12.17 + 14.22 + 12.45 + 21.74 + 20.46 + 18.23 +12.71 + 29.86 + 22.27 + 17.11 + 15.23 + 11.67 + 17.02 + 16.09 + 12.36 + 12.5 + 20.97 + 18.67 + 21.87 + 18.84 + 18.44 + 14.72 + 14.64 + 17.83 + 11.87 + 21.58 + 12.54 + 15.76 + 15.76 + 21.3747)/40 # cm^2

QUKE_leaf_area <- 40.89 # cm&2

laguna_80 <-  (QUCH_leaf_area*0.02188190)+(QUKE_leaf_area*0.127896664) # NOTE: doesn't account for PIJE species present in plot 80; no leaf area data for PIJE
laguna_81 <- (QUCH_leaf_area*0.137503524)+(QUKE_leaf_area*0.132905083) # NOTE: missing PIJE data
laguna_82 <- (QUCH_leaf_area*0.036714895)+(QUKE_leaf_area*0.204246613) # NOTE: missing PIJE data
laguna_83 <- (QUCH_leaf_area*0.030720348)+(QUKE_leaf_area*0.282228933) # NOTE: missing PIJE data
laguna_85 <- (QUKE_leaf_area*0.104909155) # NOTE: missing PIJE data
laguna_86 <- (QUKE_leaf_area*0.084400697) # NOTE: missing PIJE data
laguna_87 <- (QUCH_leaf_area*0.013481479)+(QUKE_leaf_area*0.060271165) # NOTE: missing PIJE data
laguna_88 <- (QUKE_leaf_area*0.210908254) # NOTE: missing PIJE data
laguna_89 <- "NA" # NOTE: missing PIJE and PICO data
laguna_90 <- "NA" # NOTE: nissing PIJE and PICO data
laguna_91 <- (QUKE_leaf_area*0.043702522) # NOTE: missing PIJE and PICO data
laguna_92 <- (QUKE_leaf_area*0.049942439) # NOTE: missing PIJE data
laguna_93 <- (QUKE_leaf_area*0.077707730) # NOTE: missing PIJE data
laguna_95 <- (QUKE_leaf_area*0.203380257) 
laguna_97 <- (QUKE_leaf_area*0.052624520) # NOTE: missing PIJE data
laguna_98 <- (QUKE_leaf_area*0.282672096) # NOTE: missing PIJE data
laguna_99 <- (QUKE_leaf_area*0.005792153) # NOTE: missing PIJE data
laguna_105 <- (QUKE_leaf_area*0.032854765) # NOTE: missing PIJE data
laguna_106 <- "NA" # NOTE: missing PIJE data
laguna_107 <- "NA" # NOTE: missing PIJE data
laguna_108 <- (QUKE_leaf_area*0.066777547) # NOTE: missing PIJE data
laguna_109 <- (QUKE_leaf_area*0.163879317) # NOTE: missing PIJE data
laguna_110 <- (QUCH_leaf_area*0.018574086) # NOTE: missing PIJE data
laguna_111 <- (QUKE_leaf_area*0.111012804) # NOTE: missing PIJE & PICO data
laguna_112 <- (QUKE_leaf_area*0.346895411) # NOTE: missing PIJE & PICO data
laguna_113 <- (QUKE_leaf_area*0.228543739) # NOTE: missing PIJE & PICO data
laguna_114 <- (QUKE_leaf_area*0.098418239) 
laguna_115 <- (QUKE_leaf_area*0.168117903)

# community weighted mean vector
cwm_la_laguna <- c(laguna_80, laguna_81, laguna_82, laguna_83, laguna_85, laguna_86, laguna_87, laguna_88, laguna_89, laguna_90, laguna_91, laguna_92, laguna_93, laguna_95, laguna_97, laguna_98, laguna_99, laguna_105, laguna_106, laguna_107, laguna_108, laguna_109, laguna_110, laguna_111, laguna_112, laguna_113, laguna_114, laguna_115) %>%
  as.numeric()

# data frame w/ plot ID & community weighted mean
laguna_leaf_area <- data.frame(laguna_plots, cwm_la_laguna)

# bar plot of plot x community weighted means
laguna_la_box <-ggplot(laguna_leaf_area, aes(laguna_plots, cwm_la_laguna)) + 
  geom_col(fill = "darkseagreen") +
  xlab("Plot number") +
  ylab("Community weighted mean (cm^2)") +
  theme_bw() 

# laguna_leaf_area %>% mutate(laguna_plots = fct_relevel(laguna_plots, "80", "81", "82", "83", "85", "86", "87", "88", "89", "90", "91", "92", "93", "95", "97", "98", "99", "105", "106", "107", "108", "109", "110", "111", "112", "113", "114", "115")) %>%

laguna_la_box
```

#### bluff mesa leaf area
```{r}
## bluff mesa
# calculate ABCO mean leaf area
ABCO_leaf_area <- (2.38 + 2.34 + 1.9 + 1.88 + 1.62 + 1.59 + 1.39 + 1.21 + 0.96 + 0.91 + 0.68 + 0.56 + 0.55 + 0.53 + 0.43 + 0.34 + 0.26 + 0.18 + 0.18 + 0.12 + 0.5)/21 # cm^2

bluffmesa_24 <- (ABCO_leaf_area*0.03388088) # NOTE: missing PIJE data
bluffmesa_25 <- "NA" # NOTE: missing PIJE data
bluffmesa_26 <- "NA" # NOTE: missing PIJE and ABCO data
bluffmesa_27 <- "NA" # NOTE: missing PILA data
bluffmesa_33 <- (ABCO_leaf_area*0.12813866) # NOTE: missing PIJE data
bluffmesa_48 <- (ABCO_leaf_area*0.14274096) 
bluffmesa_49 <- (ABCO_leaf_area*0.88398739) # NOTE: missing PIJE data
bluffmesa_50 <- "NA" # NOTE: missing PIJE data
bluffmesa_51 <- "NA" # NOTE: missing PIJE data
bluffmesa_52 <- (ABCO_leaf_area*0.03291174) # NOTE: missing PIJE data
bluffmesa_53 <- "NA" # NOTE: missing PIJE data

# community weighted mean vector
cwm_la_bm <- c(bluffmesa_24, bluffmesa_25, bluffmesa_26, bluffmesa_27, bluffmesa_33, bluffmesa_48, bluffmesa_49, bluffmesa_50, bluffmesa_51, bluffmesa_52, bluffmesa_53) %>%
  as.numeric()

# data frame w/ plot ID & community weighted mean
bluffmesa_leaf_area <- data.frame(bluffmesa_plots, cwm_la_bm)

# bar plot of plot x community weighted means
bluffmesa_la_box <-ggplot(bluffmesa_leaf_area, aes(bluffmesa_plots, cwm_la_bm)) + 
  geom_col(fill = "thistle3") +
  xlab("Plot number") +
  ylab("Community weighted mean (cm^2)") +
  ggtitle("Average leaf area at Bluff Mesa") +
  theme_hc(style = "darkunica") +
  scale_colour_hc("darkunica")

bluffmesa_la_box

```

#### specific leaf area
```{r}
# recall species present in the pre/post fire data
laguna_species 
bluffmesa_species 
 
# read in data from TRY database
specific_leaf_area <- read.csv("data/Veg-data/specific_leaf_area.csv") %>%
  clean_names() %>%
  select(dataset_id, dataset, species_name, trait_id, trait_name, data_name, orig_value_str, orig_unit_str, std_value, unit_name) %>%
  filter(trait_id==c("3115", "3116", "3117")) # only include rows with SLA measurements (exclude rows w/ other data measurements)

unique(specific_leaf_area$species_name) # determine the species included in the SLA data

# calculate community weighted mean (trait value x species abundance)
## laguna mountain
laguna_plots # recall all of the plots included in the laguna mountain burn area

spec_leaf_area_QUCH <- specific_leaf_area %>% # subset leaf area data to only include QUCH
  filter(specific_leaf_area$species_name == "Quercus chapmanii")
spec_leaf_area_QUKE <- specific_leaf_area %>% # subset leaf area data to only include QUKE
  filter(specific_leaf_area$species_name == c("Quercus keloggii", "Quercus kelloggii"))
spec_leaf_area_ABCO <- specific_leaf_area %>% # subset leaf area data to only include ABCO
  filter(specific_leaf_area$species_name == "Abies concolor")
spec_leaf_area_PIJE <- specific_leaf_area %>% # subset leaf area data to only include PIJE
  filter(specific_leaf_area$species_name == "Pinus jeffreyi")
spec_leaf_area_PICO <- specific_leaf_area %>% # subset leaf area data to only include PICO
  filter(specific_leaf_area$species_name == c("Pinus contorta", "Pinus contorta Douglas ex Loudon"))

## bluff mesa
bluffmesa_plots # recall all of the plots included in the bluff mesa burn area

```
##### building bar plots 
```{r}
### specific leaf area
## laguna mountain
# calculate QUCH mean specific leaf area
QUCH_spec_leaf_area <- (86.9100000253 + 76.71517672 + 81.19800333 + 69.21824104 + 102.0117351 + 74.02110998 + 99.60815047 + 90.10005266 + 118.3588317 + 66.34819533 + 98.60234445)/11 # cm^2/g

QUKE_spec_leaf_area <- (111.89) # cm^2/g

ABCO_spec_leaf_area <- (32.681 + 31.959 + 35.768 + 41.892 + 45.124 + 35.422 + 22.062 + 33.712 + 49.623 + 30.11 + 69.36753133 + 66.89536878 + 68.74095514 + 70.46476762 + 71.36563877 + 69.43231441 + 70.55837563 + .28442438 + 61.42034549 + 75.08250825 + 67.5944334 + 72.4450194 + 68.15365551 + 68.03594352 + 77.47747748 + 72.34042553 + 68.78306878 + 84.11214953 + 72.28915663 + 75 + 35.768 + 41.892 + 45.124 + 35.422 + 22.062 + 33.712 + 49.623 + 30.114)/38 # cm^2/g

PIJE_spec_leaf_area <- (30.000000003 + 30.2099999995 + 30)/3 # cm^2/g

PICO_spec_leaf_area <- (37.6 + 15.1 + 98.59960072 + 6628.693094 + 113.5000514 + 401.099687 + 729.4605253 + 921.2678931 + 162.3686046 + 56.7 + 50 + 69.4 + 48.8 + 38.97116134)/14  ### SOME OF THESE MEASUREMENTS FEEL WEIRD

laguna_80b <-  (PIJE_spec_leaf_area*0.237868275)+(QUCH_spec_leaf_area*0.02188190)+(QUKE_spec_leaf_area*0.127896664) 
laguna_81b <- (PIJE_spec_leaf_area*0.105031913)+(QUCH_spec_leaf_area*0.137503524)+(QUKE_spec_leaf_area*0.132905083) 
laguna_82b <- (PIJE_spec_leaf_area*0.224752721)+(QUCH_spec_leaf_area*0.036714895)+(QUKE_spec_leaf_area*0.204246613) 
laguna_83b <- (PIJE_spec_leaf_area*0.328016681)+(QUCH_spec_leaf_area*0.030720348)+(QUKE_spec_leaf_area*0.282228933)
laguna_85b <- (PIJE_spec_leaf_area*0.385574242)+(QUKE_spec_leaf_area*0.104909155) 
laguna_86b <- (PIJE_spec_leaf_area*0.311199977)+(QUKE_spec_leaf_area*0.084400697) 
laguna_87b <- (PIJE_spec_leaf_area*0.221507753)+(QUCH_spec_leaf_area*0.013481479)+(QUKE_spec_leaf_area*0.060271165) 
laguna_88b <- (PIJE_spec_leaf_area*0.063661211)+(QUKE_spec_leaf_area*0.210908254) 
laguna_89b <- (PIJE_spec_leaf_area*0.043035477)+(PICO_spec_leaf_area*0.145042486) 
laguna_90b <- (PIJE_spec_leaf_area*0.006773436)+(PICO_spec_leaf_area*0.157932884) 
laguna_91b <- (PIJE_spec_leaf_area*0.005395098)+(QUKE_spec_leaf_area*0.043702522)+(PICO_spec_leaf_area*0.176365612) 
laguna_92b <- (PIJE_spec_leaf_area*0.061276921)+(QUKE_spec_leaf_area*0.049942439) 
laguna_93b <- (PIJE_spec_leaf_area*0.145917065)+(QUKE_spec_leaf_area*0.077707730)
laguna_95b <- (QUKE_spec_leaf_area*0.203380257) 
laguna_97b <- (PIJE_spec_leaf_area*0.110434842)+(QUKE_spec_leaf_area*0.052624520) 
laguna_98b <- (PIJE_spec_leaf_area*0.010762981)+(QUKE_spec_leaf_area*0.282672096) 
laguna_99b <- (PIJE_spec_leaf_area*0.161122053)+(QUKE_spec_leaf_area*0.005792153) 
laguna_105b <- (PIJE_spec_leaf_area*0.244141475)+(QUKE_spec_leaf_area*0.032854765) 
laguna_106b <- (PIJE_spec_leaf_area*0.321107174) 
laguna_107b <- (PIJE_spec_leaf_area*0.566741914) 
laguna_108b <- (PIJE_spec_leaf_area*0.341350145)+(QUKE_spec_leaf_area*0.066777547) 
laguna_109b <- (PIJE_spec_leaf_area*0.329766035)+(QUKE_spec_leaf_area*0.163879317) 
laguna_110b <- (PIJE_spec_leaf_area*0.309436722)+(QUCH_spec_leaf_area*0.018574086) 
laguna_111b <- (PIJE_spec_leaf_area*0.071225233)+(QUKE_spec_leaf_area*0.111012804)+(PICO_spec_leaf_area*0.042333973) 
laguna_112b <- (PIJE_spec_leaf_area*0.093389655)+(QUKE_spec_leaf_area*0.346895411)+(PICO_spec_leaf_area*0.141405944) 
laguna_113b <- (PIJE_spec_leaf_area*0.043363615)+(QUKE_spec_leaf_area*0.228543739)+(PICO_spec_leaf_area*0.048130629) 
laguna_114b <- (QUKE_spec_leaf_area*0.098418239) 
laguna_115b <- (QUKE_spec_leaf_area*0.168117903)

# community weighted mean vector
cwm_sla_laguna <- c(laguna_80b, laguna_81b, laguna_82b, laguna_83b, laguna_85b, laguna_86b, laguna_87b, laguna_88b, laguna_89b, laguna_90b, laguna_91b, laguna_92b, laguna_93b, laguna_95b, laguna_97b, laguna_98b, laguna_99b, laguna_105b, laguna_106b, laguna_107b, laguna_108b, laguna_109b, laguna_110b, laguna_111b, laguna_112b, laguna_113b, laguna_114b, laguna_115b) %>%
  as.numeric()

# data frame w/ plot ID & community weighted mean
laguna_spec_leaf_area <- data.frame(laguna_plots, cwm_sla_laguna)

# bar plot of plot x community weighted means
laguna_sla_box <-ggplot(laguna_spec_leaf_area, aes(laguna_plots, cwm_sla_laguna)) + 
  geom_col(fill = "deepskyblue") +
  xlab("Plot number") +
  ylab("Community weighted mean (cm^2)") +
  theme_bw() 

# laguna_leaf_area %>% mutate(laguna_plots = fct_relevel(laguna_plots, "80", "81", "82", "83", "85", "86", "87", "88", "89", "90", "91", "92", "93", "95", "97", "98", "99", "105", "106", "107", "108", "109", "110", "111", "112", "113", "114", "115")) %>%

laguna_sla_box

## bluff mesa

bluffmesa_24b <- ((ABCO_spec_leaf_area*0.03388088) + (PIJE_spec_leaf_area*0.34393536))/2
bluffmesa_25b <- (PIJE_spec_leaf_area*0.10642680) 
bluffmesa_26b <- (PIJE_spec_leaf_area*0.11028369) # NOTE: missing ABCO data
bluffmesa_27b <- (PIJE_spec_leaf_area*0.34306622) 
bluffmesa_33b <- ((ABCO_leaf_area*0.12813866) + (PIJE_spec_leaf_area*0.30779671))/2 
bluffmesa_48b <- (ABCO_leaf_area*0.14274096) 
bluffmesa_49b <- ((ABCO_leaf_area*0.88398739) + (PIJE_spec_leaf_area*0.11517914))/2
bluffmesa_50b <- (PIJE_spec_leaf_area*0.11687035) 
bluffmesa_51b <- (PIJE_spec_leaf_area*0.13276554) 
bluffmesa_52b <- ((ABCO_leaf_area*0.03291174) +(PIJE_spec_leaf_area*0.01870311))/2
bluffmesa_53b <- (PIJE_spec_leaf_area*0.14539294) 

# community weighted mean vector
cwm_sla_bm <- c(bluffmesa_24b, bluffmesa_25b, bluffmesa_26b, bluffmesa_27b, bluffmesa_33b, bluffmesa_48b, bluffmesa_49b, bluffmesa_50b, bluffmesa_51b, bluffmesa_52b, bluffmesa_53b) %>%
  as.numeric()

# data frame w/ plot ID & community weighted mean
bluffmesa_spec_leaf_area <- data.frame(bluffmesa_plots, cwm_sla_bm)

# bar plot of plot x community weighted means
bluffmesa_sla_box <-ggplot(bluffmesa_spec_leaf_area, aes(bluffmesa_plots, cwm_sla_bm)) + 
  geom_col(fill = "slategray3") +
  xlab("Plot number") +
  ylab("Community weighted mean (cm^2)") +
  ggtitle("Average specific leaf area at Bluff Mesa") + 
  theme_hc(style = "darkunica") +
  scale_colour_hc("darkunica")

bluffmesa_sla_box

```

#### leaf length 
```{r}
# recall species present in the pre/post fire data
laguna_species 
bluffmesa_species 
 
# read in data from TRY database 
leaf_length <- read.csv("data/Veg-data/leaf_length.csv") %>%
  clean_names() %>%
  select(dataset_id, dataset, species_name, trait_id, trait_name, data_name, orig_value_str, orig_unit_str, std_value, unit_name) %>% 
  filter(trait_id==c("144", "940")) # only include rows with leaf length measurements (exclude rows w/ other data measurements)

unique(leaf_length$species_name) # determine the species included in the SLA data

# calculate community weighted mean (trait value x species abundance)
## laguna mountain
laguna_plots # recall all of the plots included in the laguna mountain burn area

leaf_length_QUCH <- leaf_length %>% # subset leaf length data to only include QUCH
  filter(leaf_length$species_name == "Quercus chapmanii")
leaf_length_QUKE <- leaf_length %>% # subset leaf length data to only include QUKE
  filter(leaf_length$species_name == "Quercus kelloggii")
leaf_length_ABCO <- leaf_length %>% # subset leaf length data to only include ABCO
  filter(leaf_length$species_name == "Abies concolor")
leaf_length_PIJE <- leaf_length %>% # subset leaf length data to only include PIJE
  filter(leaf_length$species_name == "Pinus jeffreyi")
leaf_length_PICO <- leaf_length %>% # subset leaf length data to only include PICO
  filter(leaf_length$species_name == "Pinus contorta")
leaf_length_PILA <- leaf_length %>% # subset leaf length data to only include PILA
  filter(leaf_length$species_name == "Pinus lambertiana") 

## bluff mesa
bluffmesa_plots # recall all of the plots included in the bluff mesa burn area

```

##### building bar plots 
```{r}
### leaf length
## laguna mountain
# calculate QUCH mean leaf length
QUCH_leaf_length <- (6.29 + 7.57 + 8.91 + 7)/3 # cm

QUKE_leaf_length <- (6) # cm

ABCO_leaf_length <- (8.609 + 7.066 + 6.023 + 5.222 + 4.367 + 3.283 + 2.837 + 2.568 + 1.711 + 1.378
 + 1.5)/11 # cm

PIJE_leaf_length <- (12 + 25)/2 # cm

PICO_leaf_length <- (7) # cm

PILA_leaf_length <- (10) # cm

laguna_80c <-  (PIJE_leaf_length*0.237868275)+(QUCH_leaf_length*0.02188190)+(QUKE_leaf_length*0.127896664) 
laguna_81c <- (PIJE_leaf_length*0.105031913)+(QUCH_leaf_length*0.137503524)+(QUKE_leaf_length*0.132905083) 
laguna_82c <- (PIJE_leaf_length*0.224752721)+(QUCH_leaf_length*0.036714895)+(QUKE_leaf_length*0.204246613) 
laguna_83c <- (PIJE_leaf_length*0.328016681)+(QUCH_leaf_length*0.030720348)+(QUKE_leaf_length*0.282228933)
laguna_85c <- (PIJE_leaf_length*0.385574242)+(QUKE_leaf_length*0.104909155) 
laguna_86c <- (PIJE_leaf_length*0.311199977)+(QUKE_leaf_length*0.084400697) 
laguna_87c <- (PIJE_leaf_length*0.221507753)+(QUCH_leaf_length*0.013481479)+(QUKE_leaf_length*0.060271165) 
laguna_88c <- (PIJE_leaf_length*0.063661211)+(QUKE_leaf_length*0.210908254) 
laguna_89c <- (PIJE_leaf_length*0.043035477)+(PICO_leaf_length*0.145042486) 
laguna_90c <- (PIJE_leaf_length*0.006773436)+(PICO_leaf_length*0.157932884) 
laguna_91c <- (PIJE_leaf_length*0.005395098)+(QUKE_leaf_length*0.043702522)+(PICO_leaf_length*0.176365612) 
laguna_92c <- (PIJE_leaf_length*0.061276921)+(QUKE_leaf_length*0.049942439) 
laguna_93c <- (PIJE_leaf_length*0.145917065)+(QUKE_leaf_length*0.077707730)
laguna_95c <- (QUKE_leaf_length*0.203380257) 
laguna_97c <- (PIJE_leaf_length*0.110434842)+(QUKE_leaf_length*0.052624520) 
laguna_98c <- (PIJE_leaf_length*0.010762981)+(QUKE_leaf_length*0.282672096) 
laguna_99c <- (PIJE_leaf_length*0.161122053)+(QUKE_leaf_length*0.005792153) 
laguna_105c <- (PIJE_leaf_length*0.244141475)+(QUKE_leaf_length*0.032854765) 
laguna_106c <- (PIJE_leaf_length*0.321107174) 
laguna_107c <- (PIJE_leaf_length*0.566741914) 
laguna_108c <- (PIJE_leaf_length*0.341350145)+(QUKE_leaf_length*0.066777547) 
laguna_109c <- (PIJE_leaf_length*0.329766035)+(QUKE_leaf_length*0.163879317) 
laguna_110c <- (PIJE_leaf_length*0.309436722)+(QUCH_leaf_length*0.018574086) 
laguna_111c <- (PIJE_leaf_length*0.071225233)+(QUKE_leaf_length*0.111012804)+(PICO_leaf_length*0.042333973) 
laguna_112c <- (PIJE_leaf_length*0.093389655)+(QUKE_leaf_length*0.346895411)+(PICO_leaf_length*0.141405944) 
laguna_113c <- (PIJE_leaf_length*0.043363615)+(QUKE_leaf_length*0.228543739)+(PICO_leaf_length*0.048130629) 
laguna_114c <- (QUKE_leaf_length*0.098418239) 
laguna_115c <- (QUKE_leaf_length*0.168117903)

# community weighted mean vector
cwm_ll_laguna <- c(laguna_80c, laguna_81c, laguna_82c, laguna_83c, laguna_85c, laguna_86c, laguna_87c, laguna_88c, laguna_89c, laguna_90c, laguna_91c, laguna_92c, laguna_93c, laguna_95c, laguna_97c, laguna_98c, laguna_99c, laguna_105c, laguna_106c, laguna_107c, laguna_108c, laguna_109c, laguna_110c, laguna_111c, laguna_112c, laguna_113c, laguna_114c, laguna_115c) %>%
  as.numeric()

# data frame w/ plot ID & community weighted mean
laguna_leaf_length <- data.frame(laguna_plots, cwm_ll_laguna)

# bar plot of plot x community weighted means
laguna_ll_box <-ggplot(laguna_leaf_length, aes(laguna_plots, cwm_ll_laguna)) + 
  geom_col(fill = "darkorchid") +
  xlab("Plot number") +
  ylab("Community weighted mean (cm^2)") +
  theme_bw() 

# laguna_leaf_area %>% mutate(laguna_plots = fct_relevel(laguna_plots, "80", "81", "82", "83", "85", "86", "87", "88", "89", "90", "91", "92", "93", "95", "97", "98", "99", "105", "106", "107", "108", "109", "110", "111", "112", "113", "114", "115")) %>%

laguna_ll_box

## bluff mesa

bluffmesa_1c <- (ABCO_leaf_length*0.033882058) 
bluffmesa_2c <- (PIJE_leaf_length*0.013756363)+(ABCO_leaf_length*0.122857311) 
bluffmesa_3c <- (PIJE_leaf_length*0.094853747)+(ABCO_leaf_length*0.065441891) 
bluffmesa_4c <- (PILA_leaf_length*0.200910212)
bluffmesa_5c <- (PIJE_leaf_length*0.331403790)+(ABCO_leaf_length*0.014806367) 
bluffmesa_6c <- (PIJE_leaf_length*0.228945297)+(ABCO_leaf_length*0.124677735) 
bluffmesa_8c <- (PIJE_leaf_length*0.551092685)+(ABCO_leaf_length*0.009390125)
bluffmesa_9c <- (PIJE_leaf_length*0.113851907)+(ABCO_leaf_length*0.416190579) 
bluffmesa_10c <- (PIJE_leaf_length*0.342088261)+(ABCO_leaf_length*0.466818858) 
bluffmesa_11c <- (PIJE_leaf_length*0.102626674)+(ABCO_leaf_length*0.141235414) 
bluffmesa_12c <- (PIJE_leaf_length*0.471040410)+(ABCO_leaf_length*0.063165479) 
bluffmesa_18c <- (PIJE_leaf_length*0.039417535) 
bluffmesa_20c <- (PIJE_leaf_length*0.219124246)+(ABCO_leaf_length*0.041526157) 
bluffmesa_23c <- (PIJE_leaf_length*0.002634505) 
bluffmesa_101c <- (PIJE_leaf_length*0.767171666) 
bluffmesa_102c <- (PIJE_leaf_length*0.009053176)+(ABCO_leaf_length*0.251733299) 
bluffmesa_103c <- (ABCO_leaf_length*0.098238703) 
bluffmesa_104c <- (PIJE_leaf_length*0.218709766)+(ABCO_leaf_length*0.109433785) 
bluffmesa_105c <- (PIJE_leaf_length*0.015300533)+(ABCO_leaf_length*0.003207769) 
bluffmesa_106c <- (PIJE_leaf_length*0.384255815)+(ABCO_leaf_area*0.078472864) 

# community weighted mean vector
cwm_ll_bm <- c(bluffmesa_1c, bluffmesa_2c, bluffmesa_3c, bluffmesa_4c, bluffmesa_5c, bluffmesa_6c, bluffmesa_8c, bluffmesa_9c, bluffmesa_10c, bluffmesa_11c, bluffmesa_12c, bluffmesa_18c, bluffmesa_20c, bluffmesa_23c, bluffmesa_101c, bluffmesa_102c, bluffmesa_103c, bluffmesa_104c, bluffmesa_105c, bluffmesa_106c) %>%
  as.numeric()

# data frame w/ plot ID & community weighted mean
bluffmesa_leaf_length <- data.frame(bluffmesa_plots, cwm_ll_bm)

# bar plot of plot x community weighted means
bluffmesa_ll_box <-ggplot(bluffmesa_leaf_length, aes(bluffmesa_plots, cwm_ll_bm)) + 
  geom_col(fill = "darkorchid") +
  xlab("Plot number") +
  ylab("Community weighted mean (cm^2)") +
  theme_bw() 

bluffmesa_ll_box

```

#### leaf dry matter content
```{r}
# read in data from TRY database 
ldmc <- read.csv("data/Veg-data/ldmc.csv") %>%
  clean_names() %>%
  select(dataset_id, dataset, species_name, trait_id, trait_name, data_name, orig_value_str, orig_unit_str, std_value, unit_name) %>% 
  filter(trait_id==c("47")) # only include rows with leaf length measurements (exclude rows w/ other data measurements)

unique(ldmc$species_name) # determine the species included in the LDMC data

# calculate community weighted mean (trait value x species abundance)
## laguna mountain
laguna_plots # recall all of the plots included in the laguna mountain burn area

ldmc_ABCO <- ldmc %>% # subset leaf length data to only include ABCO
  filter(ldmc$species_name == "Abies concolor")

## bluff mesa
bluffmesa_plots # recall all of the plots included in the bluff mesa burn area

```

### fuels bar plots
#### laguna mountain 
```{r}
# bar plot of fuel distribution in laguna mountain (tons per acre)
# save fuels as numeric
fine_fuels_num <- as.numeric(lm_fuels$fine_fuels)
hr_1_num <- as.numeric(lm_fuels$hr_1)
hr_10_num <- as.numeric(lm_fuels$hr_10)
hr_100_num <- as.numeric(lm_fuels$hr_100)
duff_litter_num <- as.numeric(lm_fuels$duff_litter)
dist_crown_num <- as.numeric(lm_fuels$distance_to_crown_ft) %>%
  na.omit()

# create vector of fine fuels sum
fine_fuels <- sum(fine_fuels_num)
hr_1 <- sum(hr_1_num)
hr_10 <- sum(hr_10_num)
hr_100 <- sum(hr_100_num)
duff_litter <- sum(duff_litter_num)
dist_crown <- sum(dist_crown_num)

# create data frame for summary of fuels across laguna mountain
lm_fuelsummary <- data.frame(
  category = c("fine fuels", "1 hr", "10 hr", "100 hr", "duff/litter"), 
  value = c(fine_fuels, hr_1, hr_10, hr_100, duff_litter)
)

# fuels summary bar plot
lm_summaryplot <- ggplot(lm_fuelsummary, aes(x=category, y=value)) + 
  geom_bar(col = "darkseagreen", fill = "darkseagreen", stat = "identity") +
  ggtitle("Summary of fuels and distance to crown at Laguna Mountain") +
  labs(y = "Fuel loading (tons/acre)", x = "Fuel category") 

# fine fuels per plot
lm_fineplot <- ggplot(lm_fuels, aes(x=plot_id, y=fine_fuels)) + 
  geom_bar(color = "darkseagreen3", fill = "darkseagreen3", stat = "identity") +
  ggtitle("Distribution of fine fuels at Laguna Mountain") +
  labs(y = "Fine fuels (tons/acre)", x = "Plot ID")

# 1 HR fuels per plot
lm_1hrplot <- ggplot(lm_fuels, aes(x=plot_id, y=hr_1)) + 
  geom_bar(color = "darkseagreen3", fill = "darkseagreen3", stat = "identity") +
  ggtitle("Distribution of 1 hour fuels at Laguna Mountain") +
  labs(y = "1 hour fuels (tons/acre)", x = "Plot ID")

# 10 HR fuels per plot
lm_10hrplot <- ggplot(lm_fuels, aes(x=plot_id, y=hr_10)) + 
  geom_bar(color = "darkseagreen3", fill = "darkseagreen3", stat = "identity") +
  ggtitle("Distribution of 10 hour fuels at Laguna Mountain") +
  labs(y = "10 hour fuels (tons/acre)", x = "Plot ID")

# 100 HR fuels per plot
lm_100hrplot <- ggplot(lm_fuels, aes(x=plot_id, y=hr_100)) + 
  geom_bar(color = "darkseagreen3", fill = "darkseagreen3", stat = "identity") +
  ggtitle("Distribution of 100 hour fuels at Laguna Mountain") +
  labs(y = "100 hour fuels (tons/acre)", x = "Plot ID")

# duff & litter per plot
lm_dufflitterplot <- ggplot(lm_fuels, aes(x=plot_id, y=duff_litter)) + 
  geom_bar(color = "darkseagreen3", fill = "darkseagreen3", stat = "identity") +
  ggtitle("Distribution of duff and litter at Laguna Mountain") +
  labs(y = "Duff and litter (tons/acre)", x = "Plot ID")

# distance to crown per plot
lm_distplot <- ggplot(lm_fuels, aes(x=plot_id, y=distance_to_crown_ft)) + 
  geom_bar(color = "darkseagreen3", fill = "darkseagreen3", stat = "identity") +
  ggtitle("Distribution of distance to crown (ft) at Laguna Mountain")  +
  labs(y = "Distance to crown (ft)", x = "Plot ID")# missing values --> no data for that plot

# total fuels per plot
lm_totalfuelsplot <- ggplot(lm_fuels, aes(x=plot_id, y=total)) + 
  geom_bar(color = "darkseagreen3", fill = "darkseagreen3", stat = "identity") +
  ggtitle("Distribution of total fuels at Laguna Mountain") +
  labs(y = "Total fuels (tons/acre)", x = "Plot ID")

lm_summaryplot
lm_fineplot
lm_1hrplot
lm_10hrplot
lm_100hrplot
lm_dufflitterplot
lm_distplot
lm_totalfuelsplot
```

#### bluff mesa
```{r}
# bar plot of fuel distribution in bluff mesa (tons per acre)
# save fuels as numeric
bhr_1_num <- as.numeric(bm_fuels$hr_1)
bhr_10_num <- as.numeric(bm_fuels$hr_10)
bhr_100_num <- as.numeric(bm_fuels$hr_100)
bduff_litter_num <- as.numeric(bm_fuels$duff_litter)
bdist_crown_num <- as.numeric(bm_fuels$distance_to_crown_ft) %>%
  na.omit()

# create vector of fine fuels sum
hr_1 <- sum(bhr_1_num)
hr_10 <- sum(bhr_10_num)
hr_100 <- sum(bhr_100_num)
duff_litter <- sum(bduff_litter_num)
dist_crown <- sum(bdist_crown_num)

# create data frame for summary of fuels across bluff mesa
bm_fuelsummary <- data.frame(
  category = c("1 hr", "10 hr", "100 hr", "duff/litter"), 
  value = c(hr_1, hr_10, hr_100, duff_litter)
)

# fuels summary bar plot
bm_summaryplot <- ggplot(bm_fuelsummary, aes(x=category, y=value)) + 
  geom_bar(col = "darkslateblue", fill = "darkslateblue", stat = "identity") +
  ggtitle("Summary of fuels and distance to crown at Bluff Mesa") +
  labs(y = "Fuel loading (tons/acre)", x = "Fuel category") 

# 1 HR fuels per plot
bm_1hrplot <- ggplot(bm_fuels, aes(x=plot_id, y=hr_1)) + 
  geom_bar(color = "slateblue", fill = "slateblue", stat = "identity") +
  ggtitle("Distribution of 1 hour fuels at Bluff Mesa") +
  labs(y = "1 hour fuels (tons/acre)", x = "Plot ID")

# 10 HR fuels per plot
bm_10hrplot <- ggplot(bm_fuels, aes(x=plot_id, y=hr_10)) + 
  geom_bar(color = "slateblue", fill = "slateblue", stat = "identity") +
  ggtitle("Distribution of 10 hour fuels at Bluff Mesa") +
  labs(y = "10 hour fuels (tons/acre)", x = "Plot ID")

# 100 HR fuels per plot
bm_100hrplot <- ggplot(bm_fuels, aes(x=plot_id, y=hr_100)) + 
  geom_bar(color = "slateblue", fill = "slateblue", stat = "identity") +
  ggtitle("Distribution of 100 hour fuels at Bluff Mesa") +
  labs(y = "100 hour fuels (tons/acre)", x = "Plot ID")

# duff & litter per plot
bm_dufflitterplot <- ggplot(bm_fuels, aes(x=plot_id, y=duff_litter)) + 
  geom_bar(color = "slateblue", fill = "slateblue", stat = "identity") +
  ggtitle("Distribution of duff and litter at Bluff Mesa") +
  labs(y = "Duff and litter (tons/acre)", x = "Plot ID")

# distance to crown per plot
bm_distplot <- ggplot(bm_fuels, aes(x=plot_id, y=distance_to_crown_ft)) + 
  geom_bar(color = "slateblue", fill = "slateblue", stat = "identity") +
  ggtitle("Distribution of distance to crown (ft) at Bluff Mesa")  +
  labs(y = "Distance to crown (ft)", x = "Plot ID")# missing values --> no data for that plot

# total fuels per plot
bm_totalfuelsplot <- ggplot(bm_fuels, aes(x=plot_id, y=total)) + 
  geom_bar(color = "slateblue", fill = "slateblue", stat = "identity") +
  ggtitle("Distribution of total fuels at Bluff Mesa") +
  labs(y = "Total fuels (tons/acre)", x = "Plot ID")

bm_summaryplot
bm_fineplot
bm_1hrplot
bm_10hrplot
bm_100hrplot
bm_dufflitterplot
bm_distplot
bm_totalfuelsplot
```

#### thomas fire
```{r}
# bar plot of fuel distribution in thomas fire (tons per acre)
# save fuels as numeric
thr_1_num <- as.numeric(tf_fuels$hr_1) %>%
  na.omit()
thr_10_num <- as.numeric(tf_fuels$hr_10) %>%
  na.omit()
thr_100_num <- as.numeric(tf_fuels$hr_100) %>%
  na.omit()
tduff_litter_num <- as.numeric(tf_fuels$duff_litter) %>%
  na.omit()
tdist_crown_num <- as.numeric(tf_fuels$distance_to_crown_ft) %>%
  na.omit()

# create vector of fine fuels sum
hr_1 <- sum(thr_1_num)
hr_10 <- sum(thr_10_num)
hr_100 <- sum(thr_100_num)
duff_litter <- sum(tduff_litter_num)
dist_crown <- sum(tdist_crown_num)

# create data frame for summary of fuels across Thomas Fire
tf_fuelsummary <- data.frame(
  category = c("1 hr", "10 hr", "100 hr", "duff/litter"), 
  value = c(hr_1, hr_10, hr_100, duff_litter)
)

# fuels summary bar plot
tf_summaryplot <- ggplot(tf_fuelsummary, aes(x=category, y=value)) + 
  geom_bar(col = "plum4", fill = "plum4", stat = "identity") +
  ggtitle("Summary of fuels and distance to crown at Thomas Fire") +
  labs(y = "Fuel loading (tons/acre)", x = "Fuel category") 

# 1 HR fuels per plot
tf_1hrplot <- ggplot(tf_fuels, aes(x=plot_id, y=hr_1)) + 
  geom_bar(color = "plum3", fill = "plum3", stat = "identity") +
  ggtitle("Distribution of 1 hour fuels at Thomas Fire") +
  labs(y = "1 hour fuels (tons/acre)", x = "Plot ID")

# 10 HR fuels per plot
tf_10hrplot <- ggplot(tf_fuels, aes(x=plot_id, y=hr_10)) + 
  geom_bar(color = "plum3", fill = "plum3", stat = "identity") +
  ggtitle("Distribution of 10 hour fuels at Thomas Fire") +
  labs(y = "10 hour fuels (tons/acre)", x = "Plot ID")

# 100 HR fuels per plot
tf_100hrplot <- ggplot(tf_fuels, aes(x=plot_id, y=hr_100)) + 
  geom_bar(color = "plum3", fill = "plum3", stat = "identity") +
  ggtitle("Distribution of 100 hour fuels at Thomas Fire") +
  labs(y = "100 hour fuels (tons/acre)", x = "Plot ID")

# duff & litter per plot
tf_dufflitterplot <- ggplot(tf_fuels, aes(x=plot_id, y=duff_litter)) + 
  geom_bar(color = "plum3", fill = "plum3", stat = "identity") +
  ggtitle("Distribution of duff and litter at Thomas Fire") +
  labs(y = "Duff and litter (tons/acre)", x = "Plot ID")

# distance to crown per plot
tf_distplot <- ggplot(tf_fuels, aes(x=plot_id, y=distance_to_crown_ft)) + 
  geom_bar(color = "plum3", fill = "plum3", stat = "identity") +
  ggtitle("Distribution of distance to crown (ft) at Thomas Fire")  +
  labs(y = "Distance to crown (ft)", x = "Plot ID")# missing values --> no data for that plot

# total fuels per plot
tf_totalfuelsplot <- ggplot(tf_fuels, aes(x=plot_id, y=total)) + 
  geom_bar(color = "plum3", fill = "plum3", stat = "identity") +
  ggtitle("Distribution of total fuels at Thomas Fire") +
  labs(y = "Total fuels (tons/acre)", x = "Plot ID")

tf_summaryplot
tf_fineplot
tf_1hrplot
tf_10hrplot
tf_100hrplot
tf_dufflitterplot
tf_distplot
tf_totalfuelsplot
```

