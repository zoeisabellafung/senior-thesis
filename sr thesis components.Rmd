---
title: "sr thesis components"
author: "Zoe Fung"
date: "8/31/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
# load required packages
library(readr)
library(ggplot2)
library(tibble)
library(ggmap)
library(janitor)
library(dplyr)
library(stringr)
library(tidyr)
library(forcats)
```

## data cleaning 

### fire severity data

#### fire locations
```{r}
# load USDA 1 dataset
USDAfires <- read.csv("data/USDA_RDA_fires_list.csv") %>%
  clean_names() %>% # standardize dataset variable names
  filter(state=="California") # subset dataset to inlcude only CA fires
# create list of fires in CA from USDA 1 dataset
CAfires <- distinct(USDAfires,yr_fire_name)

# load USDA 1 fire severity dataset
USDAseverity <- read.csv("data/USDA_RDA_pre_post_trees.csv") %>%
  clean_names() %>% # standardize dataset variable names
  filter(yr_fire_name==c(CAfires$yr_fire_name)) # subset dataset to include only CA fires

# create list of fires in CA that have species & fire severity data
CAfires_clean <- distinct(USDAseverity,yr_fire_name)

# filter USDA fires dataset to only include CA fires w/ location, species, & fire severity data
USDAfires_clean <- USDAfires %>%
  filter(yr_fire_name %in% CAfires_clean$yr_fire_name) 

# create a .csv file for USDAfires_clean
write.csv(USDAfires_clean, "USDAfires_clean.csv") # how do i specify a path for this file to be created in the data folder?

# create vectors for lat, long, and fire year/name
latitude <- c(37.279, 37.857, 38.805437, 36.874, 37.279722)
longitude <- c(-119.318, -120.086, -120.629714, -118.905, -119.50014)
yr_fire_name <- c("2013 - Aspen", "2013 - Rim", "2014 - King", "2015 - Rough", "2015 - Willow")

# create dataframe 
USDA2fires_clean <- as.data.frame(cbind(yr_fire_name,latitude,longitude))

# create a .csv file for USDA2fires_clean
write.csv(USDA2fires_clean, "USDA2fires_clean.csv")

### PLOT locations for Nicole's data -- Laguna Mtn, Bluff Mesa, & Thomas fires
# read in all plot location data & organize
laguna_location <- read_csv("data/Nicole-data/LagunaMtn_plot_coordinates.csv") %>%
  clean_names() %>% # standardize column names
  select(site_year, plot_id, treatment_unit, easting, northing) %>% # subset data 
  as.data.frame() %>%
  drop_na("plot_id")
bluffmesa_location <- read_csv("data/Nicole-data/BluffMesa_plot_coordinates.csv") %>%
  clean_names() %>% # standardize column names
  select(site_year, plot_id, treatment_unit, easting, northing) %>% # subset data
  as.data.frame() %>%
  drop_na("plot_id")
thomas_location <- read_csv("data/Nicole-data/ThomasFire_plot_coordinates.csv") %>%
  clean_names() %>% # standardize column names
  select(site_year, plot_id, treatment_unit, easting, northing) %>% # subset data 
  as.data.frame() %>%
  drop_na("plot_id")
```

#### pre-fire: USDA/USFS data
```{r}
# load USDA 1 pre & post fire data
USDA1_prefire <- read.csv("data/USDA_RDA_pre_post_trees.csv") %>%
  clean_names() %>% # standardize column names
  filter(yr_fire_name %in% USDAfires_clean$yr_fire_name) %>%
  select(yr_fire_name, species, dataset, tree_num, genus, species_name, dbh_cm, drc_cm, ht_m, hcb_pre, cr_pre, cc, vr, cl_m) # subset data to only include CA fires w/ location, species, and fire severity data

# add latitude data
USDA1_prefire <- mutate(USDA1_prefire, latitude=case_when(
    str_detect(yr_fire_name, "1989 - SEKI Crystal") ~ "36.60068",
    str_detect(yr_fire_name, "SEKI Grant West I") ~ "36.74582",
    str_detect(yr_fire_name, "SEKI Highway 2") ~ "36.57336",
    str_detect(yr_fire_name, "SEKI Tharps") ~ "36.56328",
    str_detect(yr_fire_name, "SEKI Deer Creek PNF") ~ "36.57336",
    str_detect(yr_fire_name, "SEKI Grant West") ~ "36.74582",
    str_detect(yr_fire_name, "LAVO Knob/ Lost Creek") ~ "40.56738",
    str_detect(yr_fire_name, "SEKI Hole-inthe-Wall") ~ "36.78695",
    str_detect(yr_fire_name, "SEKI Picnic Estates") ~ "36.79198",
    str_detect(yr_fire_name, "Crystal") ~ "39.51724",
    str_detect(yr_fire_name, "LAVO Butte Lake") ~ "40.58129",
    str_detect(yr_fire_name, "SEKI Mineral King") ~ "36.46600",
    str_detect(yr_fire_name, "WHIS Brandy Creek") ~ "40.61878",
    str_detect(yr_fire_name, "1996 - WHIS Shasta Divide") ~ "40.57916",
    str_detect(yr_fire_name, "REDW Mainstem") ~ "41.12729",
    str_detect(yr_fire_name, "REDW Midbasin") ~ "41.13717",
    str_detect(yr_fire_name, "Bucks") ~ "39.88539",
    str_detect(yr_fire_name, "SEKI Hercules") ~ "36.56936",
    str_detect(yr_fire_name, "SEKI Mineral KingS10") ~ "36.46601",
    str_detect(yr_fire_name, "Storrie") ~ "40.02744",
    str_detect(yr_fire_name, "Volcano Spring") ~ "39.15980",
    str_detect(yr_fire_name, "FSS2") ~ "36.59506",
    str_detect(yr_fire_name, "FSS5") ~ "36.58481",
    str_detect(yr_fire_name, "FSS6") ~ "36.58518",
    str_detect(yr_fire_name, "Southern Cascades Goosenest CA 174") ~ "41.54627",
    str_detect(yr_fire_name, "Southern Cascades Goosenest CA 178") ~ "41.56750",
    str_detect(yr_fire_name, "Southern Cascades Goosenest CA 179") ~ "41.58725",
    str_detect(yr_fire_name, "Southern Sierra Nevada Sequoia CA 1") ~ "36.59455",
    str_detect(yr_fire_name, "Southern Sierra Nevada Sequoia CA 4") ~ "36.58567",
    str_detect(yr_fire_name, "Southern Sierra Nevada Sequoia CA 5") ~ "36.58582",
    str_detect(yr_fire_name, "Star") ~ "39.09857",
    str_detect(yr_fire_name, "Swain") ~ "40.67535",
    str_detect(yr_fire_name, "Blodgett 129 - 60") ~ "38.91730",
    str_detect(yr_fire_name, "Blodgett 130 - 340") ~ "38.89821",
    str_detect(yr_fire_name, "Blodgett 131 - 400") ~ "38.89666",
    str_detect(yr_fire_name, "Cone") ~ "40.75172",
    str_detect(yr_fire_name, "McNalley") ~ "36.57336",
    str_detect(yr_fire_name, "REDW Copper Creek") ~ "41.15085",
    str_detect(yr_fire_name, "Southern Cascades Goosenest CA 181") ~ "41.60037",
    str_detect(yr_fire_name, "Southern Cascades Goosenest CA 182") ~ "41.56346",
    str_detect(yr_fire_name, "Southern Cascades Goosenest CA 183") ~ "41.55452",
    str_detect(yr_fire_name, "Southern Sierra Nevada Sequoia CA 2") ~ "36.59416",
    str_detect(yr_fire_name, "Southern Sierra Nevada Sequoia CA 3") ~ "36.59189",
    str_detect(yr_fire_name, "Southern Sierra Nevada Sequoia CA 8") ~ "36.57340",
    str_detect(yr_fire_name, "LABE South Boundary") ~ "41.69815",
    str_detect(yr_fire_name, "2003 - WHIS Shasta Divide") ~ "40.57916",
    str_detect(yr_fire_name, "Power") ~ "38.50190",
    str_detect(yr_fire_name, "Tennant") ~ "41.55805",
    str_detect(yr_fire_name, "Tharps2") ~ "36.56328",
    str_detect(yr_fire_name, "Harding") ~ "39.63345",
    str_detect(yr_fire_name, "SEKI Lewis Creek") ~ "36.76013",
    str_detect(yr_fire_name, "Angora") ~ "38.88529",
    str_detect(yr_fire_name, "Antelope") ~ "40.14120",
    str_detect(yr_fire_name, "Grass Valley") ~ "34.26739",
    str_detect(yr_fire_name, "PW-4") ~ "37.80125",
    str_detect(yr_fire_name, "American River Complex") ~ "39.22988",
    str_detect(yr_fire_name, "Peterson") ~ "40.89497",
    str_detect(yr_fire_name, "Piute") ~ "35.48923",
    str_detect(yr_fire_name, "Rich") ~ "40.06137",
    str_detect(yr_fire_name, "2008 - Seki Crystal") ~ "36.60068",
    str_detect(yr_fire_name, "WHIS White Rock") ~ "40.64606",
    str_detect(yr_fire_name, "Milford") ~ "40.10646",
    str_detect(yr_fire_name, "REDW Eastside") ~ "41.14705",
    str_detect(yr_fire_name, "Mountain") ~ "33.71030",
    str_detect(yr_fire_name, "Rim") ~ "37.90192",
    str_detect(yr_fire_name, "Salmon Complex") ~ "41.31864",
    str_detect(yr_fire_name, "Wooded Hills") ~ "32.85336"
  ))

# add longitude data
USDA1_prefire <- mutate(USDA1_prefire, longitude=case_when(
    str_detect(yr_fire_name, "1989 - SEKI Crystal") ~ "-118.8102",
    str_detect(yr_fire_name, "SEKI Grant West I") ~ "-118.9772",
    str_detect(yr_fire_name, "SEKI Highway 2") ~ "-118.7604",
    str_detect(yr_fire_name, "SEKI Tharps") ~ "-118.7428",
    str_detect(yr_fire_name, "SEKI Deer Creek PNF") ~ "-118.6585", 
    str_detect(yr_fire_name, "SEKI Grant West") ~ "-118.9772",
    str_detect(yr_fire_name, "LAVO Knob/ Lost Creek") ~ "-121.5252",
    str_detect(yr_fire_name, "SEKI Hole-inthe-Wall") ~ "-118.6302",
    str_detect(yr_fire_name, "SEKI Picnic Estates") ~ "-118.6669",
    str_detect(yr_fire_name, "Crystal") ~ "-120.0372",
    str_detect(yr_fire_name, "LAVO Butte Lake") ~ "-121.2966",
    str_detect(yr_fire_name, "SEKI Mineral King") ~ "-118.6934",
    str_detect(yr_fire_name, "WHIS Brandy Creek") ~ "-122.5739",
    str_detect(yr_fire_name, "1996 - WHIS Shasta Divide") ~ "-122.5247",
    str_detect(yr_fire_name, "REDW Mainstem") ~ "-123.8691",
    str_detect(yr_fire_name, "REDW Midbasin") ~ "-123.8881",
    str_detect(yr_fire_name, "Bucks") ~ "-121.3127",
    str_detect(yr_fire_name, "SEKI Hercules") ~ "-118.7515",
    str_detect(yr_fire_name, "SEKI Mineral KingS10") ~ "-118.6935",
    str_detect(yr_fire_name, "Storrie") ~ "-121.2872",
    str_detect(yr_fire_name, "Volcano Spring") ~ "-120.6647",
    str_detect(yr_fire_name, "FSS2") ~ "-118.7470",
    str_detect(yr_fire_name, "FSS5") ~ "-118.7552",
    str_detect(yr_fire_name, "FSS6") ~ "-118.7596",
    str_detect(yr_fire_name, "Southern Cascades Goosenest CA 174") ~ "-121.8868",
    str_detect(yr_fire_name, "Southern Cascades Goosenest CA 178") ~ "-121.8468",
    str_detect(yr_fire_name, "Southern Cascades Goosenest CA 179") ~ "-121.8417",
    str_detect(yr_fire_name, "Southern Sierra Nevada Sequoia CA 1") ~ "-118.7470",
    str_detect(yr_fire_name, "Southern Sierra Nevada Sequoia CA 4") ~ "-118.7549",
    str_detect(yr_fire_name, "Southern Sierra Nevada Sequoia CA 5") ~ "-118.7592",
    str_detect(yr_fire_name, "Star") ~ "-120.4895",
    str_detect(yr_fire_name, "Swain") ~ "-121.2609",
    str_detect(yr_fire_name, "Blodgett 129 - 60") ~ "-120.6639",
    str_detect(yr_fire_name, "Blodgett 130 - 340") ~ "-120.6545",
    str_detect(yr_fire_name, "Blodgett 131 - 400") ~ "-120.6489",
    str_detect(yr_fire_name, "Cone") ~ "-121.1582",
    str_detect(yr_fire_name, "McNalley") ~ "-118.4001",
    str_detect(yr_fire_name, "REDW Copper Creek") ~ "-123.8945",
    str_detect(yr_fire_name, "Southern Cascades Goosenest CA 181") ~ "-121.8468",
    str_detect(yr_fire_name, "Southern Cascades Goosenest CA 182") ~ "-121.8937",
    str_detect(yr_fire_name, "Southern Cascades Goosenest CA 183") ~ "-121.8638",
    str_detect(yr_fire_name, "Southern Sierra Nevada Sequoia CA 2") ~ "-118.7520",
    str_detect(yr_fire_name, "Southern Sierra Nevada Sequoia CA 3") ~ "-118.7552",
    str_detect(yr_fire_name, "Southern Sierra Nevada Sequoia CA 8") ~ "-118.7721",
    str_detect(yr_fire_name, "LABE South Boundary") ~ "-121.5030",
    str_detect(yr_fire_name, "2003 - WHIS Shasta Divide") ~ "-122.5247",
    str_detect(yr_fire_name, "Power") ~ "-120.2801",
    str_detect(yr_fire_name, "Tennant") ~ "-121.9136",
    str_detect(yr_fire_name, "Tharps2") ~ "-118.7428",
    str_detect(yr_fire_name, "Harding") ~ "-120.3098",
    str_detect(yr_fire_name, "SEKI Lewis Creek") ~ "-118.7051",
    str_detect(yr_fire_name, "Angora") ~ "-120.0365",
    str_detect(yr_fire_name, "Antelope") ~ "-120.5751",
    str_detect(yr_fire_name, "Grass Valley") ~ "-117.2301",
    str_detect(yr_fire_name, "PW-4") ~ "-119.8694",
    str_detect(yr_fire_name, "American River Complex") ~ "-120.6351",
    str_detect(yr_fire_name, "Peterson") ~ "-121.3170",
    str_detect(yr_fire_name, "Piute") ~ "-118.3568",
    str_detect(yr_fire_name, "Rich") ~ "-121.1244",
    str_detect(yr_fire_name, "2008 - Seki Crystal") ~ "-118.8102",
    str_detect(yr_fire_name, "WHIS White Rock") ~ "-122.5381",
    str_detect(yr_fire_name, "Milford") ~ "-120.3957",
    str_detect(yr_fire_name, "REDW Eastside") ~ "-123.8678",
    str_detect(yr_fire_name, "Mountain") ~ "--116.7062",
    str_detect(yr_fire_name, "Rim") ~ "--120.0836",
    str_detect(yr_fire_name, "Salmon Complex") ~ "-123.1824",
    str_detect(yr_fire_name, "Wooded Hills") ~ "-116.4381"
  ))

# determine how many data points are available for pre-fire data (include dbh measurements)
USDA1_prefire <- drop_na(USDA1_prefire, dbh_cm) %>% # 23,509 DBH data points
  distinct(yr_fire_name, species, dataset, tree_num, genus, species_name, dbh_cm, drc_cm, ht_m, hcb_pre, cr_pre, cc, vr, cl_m) # drop duplicate rows

# identify the species for which pre/post-fire data exists
USDA1_species <- distinct(USDA1_prefire, species)

# create list of the CA fires w/ pre-fire data available
USDA1pre_fires_list <- distinct(USDA1_prefire,yr_fire_name)

# create a dataset with only fire name, latitude, and longitude for pre-fire data
USDA1prefire_clean <- USDA1_prefire[, c("yr_fire_name", "latitude", "longitude")]

# remove repeat rows: keep only 1 row for each set of fire/coordinates
USDA1prefire_clean <- distinct(USDA1prefire_clean)

# write csv for USDA1 prefire data
write.csv(USDA1prefire_clean, "USDA1prefire_clean.csv")

# test mutate on a smaller data table
prefiretest <- slice(USDA1_prefire, 1:5) %>% # select first 5 rows of USDA1 prefire
  select(yr_fire_name, species, dataset) %>% # only keep first 3 variables
  mutate(latitude=case_when(
    str_detect(yr_fire_name, "Grass Valley") ~ "34.26739",
    str_detect(yr_fire_name, "FSS2") ~ "36.59506",
    str_detect(yr_fire_name, "FSS5") ~ "36.58481",
    str_detect(yr_fire_name, "McNalley") ~ "36.57336")) # add latitude column

# create data frame for USDA 1 post-fire data
USDA1_postfire <- read.csv("data/USDA_RDA_pre_post_trees.csv") %>%
  clean_names() %>% # standardize variable names
  filter(yr_fire_name %in% USDAfires_clean$yr_fire_name) %>%
  select(yr_fire_name, species, dataset, times_burned, tree_num, genus, species_name, csh_m, cls_m, clk_m, cls_percent, clk_percent, cvs_percent, cvk_percent, cbs, bcha_m, bchm_m, bch_percent, bca, ckr, gca, gir_percent) # select only columns relating to post-fire measurements

# determine how many data points are available for post-fire data (include crown scorch height & max bole char height measurements)
USDA1_postfire <- drop_na(USDA1_postfire, csh_m) %>% 
  drop_na(bchm_m) %>% 
  distinct(yr_fire_name, species, dataset, tree_num, genus, species_name, csh_m, cls_m, clk_m, cls_percent, clk_percent, cvs_percent, cvk_percent, cbs, bcha_m, bchm_m, bch_percent, bca, ckr, gca, gir_percent) # drop duplicate rows -- 6,970 data points w/ both crown scorch height and max bole char height

# load USDA 2 pre & post fire data
crag <- read.csv("data/USDA:USFS/2005_Crag/!FBAT_Trees_Crag_Rawdata")
```

#### pre-fire - Nicole's data
```{r}
# load in all pre-fire data & organize
laguna_pre <- read_csv("data/Nicole-data/LagunaMtn_pre_2016.csv") %>%
  clean_names() %>% # standardize column names
  select(project, date, id, treatment, tag_number, status, species, dbh_cm, height_m, heigt_to_crown_m, dbh_ft, basal_area_sq_ft_indiv) %>% # subset data 
  as.data.frame() %>%
  rename("height_to_crown_m"="heigt_to_crown_m", "plot_id"="id", "treatment_unit"="treatment") %>%
  mutate(tree_area = ((pi*(laguna_pre$dbh_cm^2)/4)/100)) # add column w/ area measurements for each tree
bluffmesa_pre <- read_csv("data/Nicole-data/BluffMesa_pre_2016.csv") %>%
  clean_names() %>% # standardize column names
  select(project, date, id, treatment, tag_number, status, species, dbh_cm, height_m, heigt_to_crown_m, dbh_ft, ba_indiv_sq_ft) %>% # subset data 
  as.data.frame() %>%
  rename("height_to_crown_m"="heigt_to_crown_m", "plot_id"="id", "treatment_unit"="treatment", "basal_area_sq_ft_indiv"="ba_indiv_sq_ft") %>%
  mutate(tree_area = ((pi*(bluffmesa_pre$dbh_cm^2)/4)/100)) # add column with area measurements for each tree

# since location data is organized by PLOT, find tree area per plot (subset by species)
laguna_species <- unique(laguna_pre$species) # create list of all species present in laguna fire data
laguna_pre <- laguna_pre %>%
  drop_na("species") # drop rows where species is not specified

laguna_pre_PIJE <- filter(laguna_pre, species == "PIJE") # create data frame w/ only PIJE sp.
laguna_pre_QUCH <- filter(laguna_pre, species == "QUCH") # create data frame w/ only QUCH sp.
laguna_pre_QUKE <- filter(laguna_pre, species == "QUKE") # create data frame w/ only QUKE sp.
laguna_pre_PICO <- filter(laguna_pre, species == "PICO") # create data frame w/ only PICO sp.
laguna_pre_CADE <- filter(laguna_pre, species == "CADE") # create data frame w/ only CADE sp. --> I did not end up including this species in my leaf trait data since it wasn't listed as a species in the TRY database

#### PIJE

laguna_pre_PIJE_plots <- unique(laguna_pre_PIJE$plot_id) # print each plot ID where PIJE is present

# create a data frame for each plot 
## NOTE: each plot is an 11.3m radius circular plot
laguna_pre_PIJE_80 <- filter(laguna_pre_PIJE, plot_id == "80")
laguna_pre_PIJE_81 <- filter(laguna_pre_PIJE, plot_id == "81")
laguna_pre_PIJE_82 <- filter(laguna_pre_PIJE, plot_id == "82")
laguna_pre_PIJE_83 <- filter(laguna_pre_PIJE, plot_id == "83")
laguna_pre_PIJE_85 <- filter(laguna_pre_PIJE, plot_id == "85")
laguna_pre_PIJE_86 <- filter(laguna_pre_PIJE, plot_id == "86")
laguna_pre_PIJE_87 <- filter(laguna_pre_PIJE, plot_id == "87")
laguna_pre_PIJE_88 <- filter(laguna_pre_PIJE, plot_id == "88")
laguna_pre_PIJE_89 <- filter(laguna_pre_PIJE, plot_id == "89")
laguna_pre_PIJE_90 <- filter(laguna_pre_PIJE, plot_id == "90")
laguna_pre_PIJE_91 <- filter(laguna_pre_PIJE, plot_id == "91")
laguna_pre_PIJE_92 <- filter(laguna_pre_PIJE, plot_id == "92")
laguna_pre_PIJE_93 <- filter(laguna_pre_PIJE, plot_id == "93")
laguna_pre_PIJE_97 <- filter(laguna_pre_PIJE, plot_id == "97")
laguna_pre_PIJE_98 <- filter(laguna_pre_PIJE, plot_id == "98")
laguna_pre_PIJE_99 <- filter(laguna_pre_PIJE, plot_id == "99")
laguna_pre_PIJE_105 <- filter(laguna_pre_PIJE, plot_id == "105")
laguna_pre_PIJE_106 <- filter(laguna_pre_PIJE, plot_id == "106")
laguna_pre_PIJE_107 <- filter(laguna_pre_PIJE, plot_id == "107")
laguna_pre_PIJE_108 <- filter(laguna_pre_PIJE, plot_id == "108")
laguna_pre_PIJE_109 <- filter(laguna_pre_PIJE, plot_id == "109")
laguna_pre_PIJE_110 <- filter(laguna_pre_PIJE, plot_id == "110")
laguna_pre_PIJE_111 <- filter(laguna_pre_PIJE, plot_id == "111")
laguna_pre_PIJE_112 <- filter(laguna_pre_PIJE, plot_id == "112")
laguna_pre_PIJE_113 <- filter(laguna_pre_PIJE, plot_id == "113")

# calculate plot area
plot_area <- pi*(11.3^2)
## plot area = 401.15m^2

# create vectors of the sum of each species' area per plot
l_p_80 <- sum(laguna_pre_PIJE_80$tree_area)
l_p_81 <- sum(laguna_pre_PIJE_81$tree_area)
l_p_82 <- sum(laguna_pre_PIJE_82$tree_area)
l_p_83 <- sum(laguna_pre_PIJE_83$tree_area)
l_p_85 <- sum(laguna_pre_PIJE_85$tree_area)
l_p_86 <- sum(laguna_pre_PIJE_86$tree_area)
l_p_87 <- sum(laguna_pre_PIJE_87$tree_area)
l_p_88 <- sum(laguna_pre_PIJE_88$tree_area)
l_p_89 <- sum(laguna_pre_PIJE_89$tree_area)
l_p_90 <- sum(laguna_pre_PIJE_90$tree_area)
l_p_91 <- sum(laguna_pre_PIJE_91$tree_area)
l_p_92 <- sum(laguna_pre_PIJE_92$tree_area)
l_p_93 <- sum(laguna_pre_PIJE_93$tree_area)
l_p_97 <- sum(laguna_pre_PIJE_97$tree_area)
l_p_98 <- sum(laguna_pre_PIJE_98$tree_area)
l_p_99 <- sum(laguna_pre_PIJE_99$tree_area)
l_p_105 <- sum(laguna_pre_PIJE_105$tree_area)
l_p_106 <- sum(laguna_pre_PIJE_106$tree_area)
l_p_107 <- sum(laguna_pre_PIJE_107$tree_area)
l_p_108 <- sum(laguna_pre_PIJE_108$tree_area)
l_p_109 <- sum(laguna_pre_PIJE_109$tree_area)
l_p_110 <- sum(laguna_pre_PIJE_110$tree_area)
l_p_111 <- sum(laguna_pre_PIJE_111$tree_area)
l_p_112 <- sum(laguna_pre_PIJE_112$tree_area)
l_p_113 <- sum(laguna_pre_PIJE_113$tree_area)

# create data frame: project, year, plot_id, & abundance for PIJE
laguna_pre_PIJE_clean <- data.frame(
  project = rep("Laguna Mtn.", times = length(laguna_pre_PIJE_plots)), 
  year = rep("2016", times = length(laguna_pre_PIJE_plots)),
  species = rep("PIJE", times = length(laguna_pre_PIJE_plots)),
  plot_id = c(laguna_pre_PIJE_plots),
  abundance = c(l_p_80/plot_area, l_p_81/plot_area, l_p_82/plot_area, l_p_83/plot_area, l_p_85/plot_area, l_p_86/plot_area, l_p_87/plot_area, l_p_88/plot_area, l_p_89/plot_area, l_p_90/plot_area, l_p_91/plot_area, l_p_92/plot_area, l_p_93/plot_area, l_p_97/plot_area, l_p_98/plot_area, l_p_99/plot_area, l_p_105/plot_area, l_p_106/plot_area, l_p_107/plot_area, l_p_108/plot_area, l_p_109/plot_area, l_p_110/plot_area, l_p_111/plot_area, l_p_112/plot_area, l_p_113/plot_area)
)

#### QUCH

laguna_pre_QUCH_plots <- unique(laguna_pre_QUCH$plot_id) # print each plot ID where QUCH is present

# create a data frame for each plot 
## NOTE: each plot is an 11.3m radius circular plot
laguna_pre_QUCH_80 <- filter(laguna_pre_QUCH, plot_id == "80")
laguna_pre_QUCH_81 <- filter(laguna_pre_QUCH, plot_id == "81")
laguna_pre_QUCH_82 <- filter(laguna_pre_QUCH, plot_id == "82")
laguna_pre_QUCH_83 <- filter(laguna_pre_QUCH, plot_id == "83")
laguna_pre_QUCH_87 <- filter(laguna_pre_QUCH, plot_id == "87")
laguna_pre_QUCH_110 <- filter(laguna_pre_QUCH, plot_id == "110")

## plot area = 401.15m^2

# create vectors of the sum of each species' area per plot
l_qc_80 <- sum(laguna_pre_QUCH_80$tree_area)
l_qc_81 <- sum(laguna_pre_QUCH_81$tree_area)
l_qc_82 <- sum(laguna_pre_QUCH_82$tree_area)
l_qc_83 <- sum(laguna_pre_QUCH_83$tree_area)
l_qc_87 <- sum(laguna_pre_QUCH_87$tree_area)
l_qc_110 <- sum(laguna_pre_QUCH_110$tree_area)

# create data frame: project, year, plot_id, & abundance for PIJE
laguna_pre_QUCH_clean <- data.frame(
  project = rep("Laguna Mtn.", times = length(laguna_pre_QUCH_plots)), # how do i get the length to match the vector length rather than having to manually type in a length?
  year = rep("2016", times = length(laguna_pre_QUCH_plots)),
  species = rep("QUCH", times = length(laguna_pre_QUCH_plots)),
  plot_id = c(laguna_pre_QUCH_plots),
  abundance = c(l_qc_80/plot_area, l_qc_81/plot_area, l_qc_82/plot_area, l_qc_83/plot_area, l_qc_87/plot_area, l_qc_110/plot_area)
)

#### QUKE

laguna_pre_QUKE_plots <- unique(laguna_pre_QUKE$plot_id) # print each plot ID where QUKE is present

# create a data frame for each plot 
## NOTE: each plot is an 11.3m radius circular plot
laguna_pre_QUKE_80 <- filter(laguna_pre_QUKE, plot_id == "80")
laguna_pre_QUKE_81 <- filter(laguna_pre_QUKE, plot_id == "81")
laguna_pre_QUKE_82 <- filter(laguna_pre_QUKE, plot_id == "82")
laguna_pre_QUKE_83 <- filter(laguna_pre_QUKE, plot_id == "83")
laguna_pre_QUKE_85 <- filter(laguna_pre_QUKE, plot_id == "85")
laguna_pre_QUKE_86 <- filter(laguna_pre_QUKE, plot_id == "86")
laguna_pre_QUKE_87 <- filter(laguna_pre_QUKE, plot_id == "87")
laguna_pre_QUKE_88 <- filter(laguna_pre_QUKE, plot_id == "88")
laguna_pre_QUKE_91 <- filter(laguna_pre_QUKE, plot_id == "91")
laguna_pre_QUKE_92 <- filter(laguna_pre_QUKE, plot_id == "92")
laguna_pre_QUKE_93 <- filter(laguna_pre_QUKE, plot_id == "93")
laguna_pre_QUKE_95 <- filter(laguna_pre_QUKE, plot_id == "95")
laguna_pre_QUKE_97 <- filter(laguna_pre_QUKE, plot_id == "97")
laguna_pre_QUKE_98 <- filter(laguna_pre_QUKE, plot_id == "98")
laguna_pre_QUKE_99 <- filter(laguna_pre_QUKE, plot_id == "99")
laguna_pre_QUKE_105 <- filter(laguna_pre_QUKE, plot_id == "105")
laguna_pre_QUKE_108 <- filter(laguna_pre_QUKE, plot_id == "108")
laguna_pre_QUKE_109 <- filter(laguna_pre_QUKE, plot_id == "109")
laguna_pre_QUKE_111 <- filter(laguna_pre_QUKE, plot_id == "111")
laguna_pre_QUKE_112 <- filter(laguna_pre_QUKE, plot_id == "112")
laguna_pre_QUKE_113 <- filter(laguna_pre_QUKE, plot_id == "113")
laguna_pre_QUKE_114 <- filter(laguna_pre_QUKE, plot_id == "114")
laguna_pre_QUKE_115 <- filter(laguna_pre_QUKE, plot_id == "115")

## plot area = 401.15m^2

# create vectors of the sum of each species' area per plot
l_qk_80 <- sum(laguna_pre_QUKE_80$tree_area)
l_qk_81 <- sum(laguna_pre_QUKE_81$tree_area)
l_qk_82 <- sum(laguna_pre_QUKE_82$tree_area)
l_qk_83 <- sum(laguna_pre_QUKE_83$tree_area)
l_qk_85 <- sum(laguna_pre_QUKE_85$tree_area)
l_qk_86 <- sum(laguna_pre_QUKE_86$tree_area)
l_qk_87 <- sum(laguna_pre_QUKE_87$tree_area)
l_qk_88 <- sum(laguna_pre_QUKE_88$tree_area)
l_qk_91 <- sum(laguna_pre_QUKE_91$tree_area)
l_qk_92 <- sum(laguna_pre_QUKE_92$tree_area)
l_qk_93 <- sum(laguna_pre_QUKE_93$tree_area)
l_qk_95 <- sum(laguna_pre_QUKE_95$tree_area)
l_qk_97 <- sum(laguna_pre_QUKE_97$tree_area)
l_qk_98 <- sum(laguna_pre_QUKE_98$tree_area)
l_qk_99 <- sum(laguna_pre_QUKE_99$tree_area)
l_qk_105 <- sum(laguna_pre_QUKE_105$tree_area)
l_qk_108 <- sum(laguna_pre_QUKE_108$tree_area)
l_qk_109 <- sum(laguna_pre_QUKE_109$tree_area)
l_qk_111 <- sum(laguna_pre_QUKE_111$tree_area)
l_qk_112 <- sum(laguna_pre_QUKE_112$tree_area)
l_qk_113 <- sum(laguna_pre_QUKE_113$tree_area)
l_qk_114 <- sum(laguna_pre_QUKE_114$tree_area)
l_qk_115 <- sum(laguna_pre_QUKE_115$tree_area)

# create data frame: project, year, plot_id, & abundance for PIJE
laguna_pre_QUKE_clean <- data.frame(
  project = rep("Laguna Mtn.", times = length(laguna_pre_QUKE_plots)), 
  year = rep("2016", times = length(laguna_pre_QUKE_plots)),
  species = rep("QUKE", times = length(laguna_pre_QUKE_plots)),
  plot_id = c(laguna_pre_QUKE_plots),
  abundance = c(l_qk_80/plot_area, l_qk_81/plot_area, l_qk_82/plot_area, l_qk_83/plot_area, l_qk_85/plot_area, l_qk_86/plot_area, l_qk_87/plot_area, l_qk_88/plot_area, l_qk_91/plot_area, l_qk_92/plot_area, l_qk_93/plot_area, l_qk_95/plot_area, l_qk_97/plot_area, l_qk_98/plot_area, l_qk_99/plot_area, l_qk_105/plot_area, l_qk_108/plot_area, l_qk_109/plot_area, l_qk_111/plot_area, l_qk_112/plot_area, l_qk_113/plot_area, l_qk_114/plot_area, l_qk_115/plot_area)
)

#### PICO

laguna_pre_PICO_plots <- unique(laguna_pre_PICO$plot_id) # print each plot ID where PICO is present

# create a data frame for each plot 
## NOTE: each plot is an 11.3m radius circular plot
laguna_pre_PICO_89 <- filter(laguna_pre_PICO, plot_id == "89")
laguna_pre_PICO_90 <- filter(laguna_pre_PICO, plot_id == "90")
laguna_pre_PICO_91 <- filter(laguna_pre_PICO, plot_id == "91")
laguna_pre_PICO_111 <- filter(laguna_pre_PICO, plot_id == "111")
laguna_pre_PICO_112 <- filter(laguna_pre_PICO, plot_id == "112")
laguna_pre_PICO_113 <- filter(laguna_pre_PICO, plot_id == "113")

## plot area = 401.15m^2

# create vectors of the sum of each species' area per plot
l_pc_89 <- sum(laguna_pre_PICO_89$tree_area)
l_pc_90 <- sum(laguna_pre_PICO_90$tree_area)
l_pc_91 <- sum(laguna_pre_PICO_91$tree_area)
l_pc_111 <- sum(laguna_pre_PICO_111$tree_area)
l_pc_112 <- sum(laguna_pre_PICO_112$tree_area)
l_pc_113 <- sum(laguna_pre_PICO_113$tree_area)

# create data frame: project, year, plot_id, & abundance for PICO
laguna_pre_PICO_clean <- data.frame(
  project = rep("Laguna Mtn.", times = length(laguna_pre_PICO_plots)), 
  year = rep("2016", times = length(laguna_pre_PICO_plots)),
  species = rep("PICO", times = length(laguna_pre_PICO_plots)),
  plot_id = c(laguna_pre_PICO_plots),
  abundance = c(l_pc_89/plot_area, l_pc_90/plot_area, l_pc_91/plot_area, l_pc_111/plot_area, l_pc_112/plot_area, l_pc_113/plot_area)
)

# combine all pre-fire data from laguna plots
laguna_pre_clean <- rbind(laguna_pre_PIJE_clean, laguna_pre_QUCH_clean, laguna_pre_QUKE_clean, laguna_pre_PICO_clean)

# repeat for bluff mesa
bluffmesa_species <- unique(bluffmesa_pre$species) # create list of all species present in laguna fire data
bluffmesa_pre <- bluffmesa_pre %>%
  drop_na("species") # drop rows where species is not specified

bluffmesa_pre_ABCO <- filter(bluffmesa_pre, species == "ABCO") # create data frame w/ only ABCO sp.
bluffmesa_pre_PIJE <- filter(bluffmesa_pre, species == "PIJE") # create data frame w/ only PIJE sp.
bluffmesa_pre_PILA <- filter(bluffmesa_pre, species == "PILA") # create data frame w/ only PILA sp.

#### ABCO

bluffmesa_pre_ABCO_plots <- unique(bluffmesa_pre_ABCO$plot_id) # print each plot ID where ABCO is present

# create a data frame for each plot 
## NOTE: each plot is an 11.3m radius circular plot
bluffmesa_pre_ABCO_1 <- filter(bluffmesa_pre_ABCO, plot_id == "1")
bluffmesa_pre_ABCO_2 <- filter(bluffmesa_pre_ABCO, plot_id == "2")
bluffmesa_pre_ABCO_3 <- filter(bluffmesa_pre_ABCO, plot_id == "3")
bluffmesa_pre_ABCO_5 <- filter(bluffmesa_pre_ABCO, plot_id == "5")
bluffmesa_pre_ABCO_6 <- filter(bluffmesa_pre_ABCO, plot_id == "6")
bluffmesa_pre_ABCO_8 <- filter(bluffmesa_pre_ABCO, plot_id == "8")
bluffmesa_pre_ABCO_9 <- filter(bluffmesa_pre_ABCO, plot_id == "9")
bluffmesa_pre_ABCO_10 <- filter(bluffmesa_pre_ABCO, plot_id == "10")
bluffmesa_pre_ABCO_11 <- filter(bluffmesa_pre_ABCO, plot_id == "11")
bluffmesa_pre_ABCO_12 <- filter(bluffmesa_pre_ABCO, plot_id == "12")
bluffmesa_pre_ABCO_20 <- filter(bluffmesa_pre_ABCO, plot_id == "20")
bluffmesa_pre_ABCO_102 <- filter(bluffmesa_pre_ABCO, plot_id == "102")
bluffmesa_pre_ABCO_103 <- filter(bluffmesa_pre_ABCO, plot_id == "103")
bluffmesa_pre_ABCO_104 <- filter(bluffmesa_pre_ABCO, plot_id == "104")
bluffmesa_pre_ABCO_105 <- filter(bluffmesa_pre_ABCO, plot_id == "105")
bluffmesa_pre_ABCO_106 <- filter(bluffmesa_pre_ABCO, plot_id == "106")

# calculate plot area
plot_area <- pi*(11.3^2)
## plot area = 401.15m^2

# create vectors of the sum of each species' area per plot
bm_a1 <- sum(bluffmesa_pre_ABCO_1$tree_area)
bm_a2 <- sum(bluffmesa_pre_ABCO_2$tree_area)
bm_a3 <- sum(bluffmesa_pre_ABCO_3$tree_area)
bm_a5 <- sum(bluffmesa_pre_ABCO_5$tree_area)
bm_a6 <- sum(bluffmesa_pre_ABCO_6$tree_area)
bm_a8 <- sum(bluffmesa_pre_ABCO_8$tree_area)
bm_a9 <- sum(bluffmesa_pre_ABCO_9$tree_area)
bm_a10 <- sum(bluffmesa_pre_ABCO_10$tree_area)
bm_a11 <- sum(bluffmesa_pre_ABCO_11$tree_area)
bm_a12 <- sum(bluffmesa_pre_ABCO_12$tree_area)
bm_a20 <- sum(bluffmesa_pre_ABCO_20$tree_area)
bm_a102 <- sum(bluffmesa_pre_ABCO_102$tree_area)
bm_a103 <- sum(bluffmesa_pre_ABCO_103$tree_area)
bm_a104 <- sum(bluffmesa_pre_ABCO_104$tree_area)
bm_a105 <- sum(bluffmesa_pre_ABCO_105$tree_area)
bm_a106 <- sum(bluffmesa_pre_ABCO_106$tree_area)

# create data frame: project, year, plot_id, & abundance for ABCO
bluffmesa_pre_ABCO_clean <- data.frame(
  project = rep("Bluff Mesa", times = length(bluffmesa_pre_ABCO_plots)), 
  year = rep("2016", times = length(bluffmesa_pre_ABCO_plots)),
  species = rep("ABCO", times = length(bluffmesa_pre_ABCO_plots)),
  plot_id = c(bluffmesa_pre_ABCO_plots),
  abundance = c(bm_a1/plot_area, bm_a2/plot_area, bm_a3/plot_area, bm_a5/plot_area, bm_a6/plot_area, bm_a8/plot_area, bm_a9/plot_area, bm_a10/plot_area, bm_a11/plot_area, bm_a12/plot_area, bm_a20/plot_area, bm_a102/plot_area, bm_a103/plot_area, bm_a104/plot_area, bm_a105/plot_area, bm_a106/plot_area)
)

#### PIJE

bluffmesa_pre_PIJE_plots <- unique(bluffmesa_pre_PIJE$plot_id) # print each plot ID where PIJE is present

# create a data frame for each plot 
## NOTE: each plot is an 11.3m radius circular plot
bluffmesa_pre_PIJE_2 <- filter(bluffmesa_pre_PIJE, plot_id == "2")
bluffmesa_pre_PIJE_3 <- filter(bluffmesa_pre_PIJE, plot_id == "3")
bluffmesa_pre_PIJE_5 <- filter(bluffmesa_pre_PIJE, plot_id == "5")
bluffmesa_pre_PIJE_6 <- filter(bluffmesa_pre_PIJE, plot_id == "6")
bluffmesa_pre_PIJE_8 <- filter(bluffmesa_pre_PIJE, plot_id == "8")
bluffmesa_pre_PIJE_9 <- filter(bluffmesa_pre_PIJE, plot_id == "9")
bluffmesa_pre_PIJE_10 <- filter(bluffmesa_pre_PIJE, plot_id == "10")
bluffmesa_pre_PIJE_11 <- filter(bluffmesa_pre_PIJE, plot_id == "11")
bluffmesa_pre_PIJE_12 <- filter(bluffmesa_pre_PIJE, plot_id == "12")
bluffmesa_pre_PIJE_18 <- filter(bluffmesa_pre_PIJE, plot_id == "18")
bluffmesa_pre_PIJE_20 <- filter(bluffmesa_pre_PIJE, plot_id == "20")
bluffmesa_pre_PIJE_23 <- filter(bluffmesa_pre_PIJE, plot_id == "23")
bluffmesa_pre_PIJE_101 <- filter(bluffmesa_pre_PIJE, plot_id == "101")
bluffmesa_pre_PIJE_102 <- filter(bluffmesa_pre_PIJE, plot_id == "102")
bluffmesa_pre_PIJE_104 <- filter(bluffmesa_pre_PIJE, plot_id == "104")
bluffmesa_pre_PIJE_105 <- filter(bluffmesa_pre_PIJE, plot_id == "105")
bluffmesa_pre_PIJE_106 <- filter(bluffmesa_pre_PIJE, plot_id == "106")

# create vectors of the sum of each species' area per plot
bm_p2 <- sum(bluffmesa_pre_PIJE_2$tree_area)
bm_p3 <- sum(bluffmesa_pre_PIJE_3$tree_area)
bm_p5 <- sum(bluffmesa_pre_PIJE_5$tree_area)
bm_p6 <- sum(bluffmesa_pre_PIJE_6$tree_area)
bm_p8 <- sum(bluffmesa_pre_PIJE_8$tree_area)
bm_p9 <- sum(bluffmesa_pre_PIJE_9$tree_area)
bm_p10 <- sum(bluffmesa_pre_PIJE_10$tree_area)
bm_p11 <- sum(bluffmesa_pre_PIJE_11$tree_area)
bm_p12 <- sum(bluffmesa_pre_PIJE_12$tree_area)
bm_p18 <- sum(bluffmesa_pre_PIJE_18$tree_area)
bm_p20 <- sum(bluffmesa_pre_PIJE_20$tree_area)
bm_p23 <- sum(bluffmesa_pre_PIJE_23$tree_area)
bm_p101 <- sum(bluffmesa_pre_PIJE_101$tree_area)
bm_p102 <- sum(bluffmesa_pre_PIJE_102$tree_area)
bm_p104 <- sum(bluffmesa_pre_PIJE_104$tree_area)
bm_p105 <- sum(bluffmesa_pre_PIJE_105$tree_area)
bm_p106 <- sum(bluffmesa_pre_PIJE_106$tree_area)

# create data frame: project, year, plot_id, & abundance for PIJE
bluffmesa_pre_PIJE_clean <- data.frame(
  project = rep("Bluff Mesa", times = length(bluffmesa_pre_PIJE_plots)), 
  year = rep("2016", times = length(bluffmesa_pre_PIJE_plots)),
  species = rep("PIJE", times = length(bluffmesa_pre_PIJE_plots)),
  plot_id = c(bluffmesa_pre_PIJE_plots),
  abundance = c(bm_p2/plot_area, bm_p3/plot_area, bm_p5/plot_area, bm_p6/plot_area, bm_p8/plot_area, bm_p9/plot_area, bm_p10/plot_area, bm_p11/plot_area, bm_p12/plot_area, bm_p18/plot_area, bm_p20/plot_area, bm_p23/plot_area, bm_p101/plot_area, bm_p102/plot_area, bm_p104/plot_area, bm_p105/plot_area, bm_p106/plot_area)
)

#### PILA

bluffmesa_pre_PILA_plots <- unique(bluffmesa_pre_PILA$plot_id) # print each plot ID where PILA is present

# create a data frame for each plot 
## NOTE: each plot is an 11.3m radius circular plot
bluffmesa_pre_PILA_4 <- filter(bluffmesa_pre_PILA, plot_id == "4")

# create vectors of the sum of each species' area per plot
bm_pl4 <- sum(bluffmesa_pre_PILA_4$tree_area)

# create data frame: project, year, plot_id, & abundance for PILA
bluffmesa_pre_PILA_clean <- data.frame(
  project = rep("Bluff Mesa", times = length(bluffmesa_pre_PILA_plots)), 
  year = rep("2016", times = length(bluffmesa_pre_PILA_plots)),
  species = rep("PILA", times = length(bluffmesa_pre_PILA_plots)),
  plot_id = c(bluffmesa_pre_PILA_plots),
  abundance = c(bm_pl4/plot_area)
)

# combine all pre-fire data from laguna plots
bluffmesa_pre_clean <- rbind(bluffmesa_pre_ABCO_clean, bluffmesa_pre_PIJE_clean, bluffmesa_pre_PILA_clean)
```

### post-fire data
#### Nicole's data
```{r}
# load in all post-fire data
laguna_post <- read_csv("data/Nicole-data/LagunaMtn_post_2017.csv")
bluffmeas_post <- read_csv("data/Nicole-data/BluffMesa_post_2021.csv")
thomas_post1 <- read_csv("data/Nicole-data/ThomasFire_post_2018.csv")
thomas_post2 <- read_csv("data/Nicole-data/ThomasFire_post_2018_2.csv")
```

### leaf trait data
```{r}
# determine the species present in the pre/post fire data
laguna_species <- unique(laguna_pre$species) # create list of all species present in laguna fire data
bluffmesa_species <- unique(bluffmesa_pre$species) # create list of all species present in bluff mesa fire data
 
# read in data from TRY database
leaf_area <- read.csv("data/Veg-data/leaf_area.csv") %>%
  clean_names() %>%
  select(dataset_id, dataset, species_name, trait_id, trait_name, data_name, orig_value_str, orig_unit_str, std_value) %>%
  slice_head(n = 65)

# calculate community weighted mean (trait value x species abundance)
## laguna mountain
laguna_plots <- unique(laguna_pre$plot_id) %>% # list all of the plots included in the laguna mountain burn area
  as.character()
leaf_area_QUCH <- leaf_area %>% # subset leaf area data to only include QUCH
  filter(leaf_area$species_name == "Quercus chapmanii")
leaf_area_QUKE <- leaf_area %>% # subset leaf area data to only include QUKE
  filter(leaf_area$species_name == "Quercus keloggii")
leaf_area_ABCO <- leaf_area %>% # subset leaf area data to only include ABCO
  filter(leaf_area$species_name == "Abies concolor")
```


#### building bar plots
```{r}
### leaf area
## laguna mountain
# calculate QUCH mean leaf area
QUCH_leaf_area <- (15.76+14.76+28.2+18.57+14.29+21.47+24.14+17+9.53+15.16+12.17+14.22+12.45+21.74+20.46+18.23+12.71+29.86+22.27+17.11+15.23+11.67+17.02+16.09+12.36+12.5+20.97+18.67+21.87+18.84+18.44+14.72+14.64+17.83+11.87+21.58+12.54+15.76+15.76+21.3747)/40 

QUKE_leaf_area <- 40.89

laguna_80 <-  (QUCH_leaf_area*0.02188190)+(QUKE_leaf_area*0.127896664) # NOTE: doesn't account for PIJE species present in plot 80; no leaf area data for PIJE
laguna_81 <- (QUCH_leaf_area*0.137503524)+(QUKE_leaf_area*0.132905083) # NOTE: missing PIJE data
laguna_82 <- (QUCH_leaf_area*0.036714895)+(QUKE_leaf_area*0.204246613) # NOTE: missing PIJE data
laguna_83 <- (QUCH_leaf_area*0.030720348)+(QUKE_leaf_area*0.282228933) # NOTE: missing PIJE data
laguna_85 <- (QUKE_leaf_area*0.104909155) # NOTE: missing PIJE data
laguna_86 <- (QUKE_leaf_area*0.084400697) # NOTE: missing PIJE data
laguna_87 <- (QUCH_leaf_area*0.013481479)+(QUKE_leaf_area*0.060271165) # NOTE: missing PIJE data
laguna_88 <- (QUKE_leaf_area*0.210908254) # NOTE: missing PIJE data
laguna_89 <- "NA" # NOTE: missing PIJE and PICO data
laguna_90 <- "NA" # NOTE: nissing PIJE and PICO data
laguna_91 <- (QUKE_leaf_area*0.043702522) # NOTE: missing PIJE and PICO data
laguna_92 <- (QUKE_leaf_area*0.049942439) # NOTE: missing PIJE data
laguna_93 <- (QUKE_leaf_area*0.077707730) # NOTE: missing PIJE data
laguna_95 <- (QUKE_leaf_area*0.203380257) 
laguna_97 <- (QUKE_leaf_area*0.052624520) # NOTE: missing PIJE data
laguna_98 <- (QUKE_leaf_area*0.282672096) # NOTE: missing PIJE data
laguna_99 <- (QUKE_leaf_area*0.005792153) # NOTE: missing PIJE data
laguna_105 <- (QUKE_leaf_area*0.032854765) # NOTE: missing PIJE data
laguna_106 <- "NA" # NOTE: missing PIJE data
laguna_107 <- "NA" # NOTE: missing PIJE data
laguna_108 <- (QUKE_leaf_area*0.066777547) # NOTE: missing PIJE data
laguna_109 <- (QUKE_leaf_area*0.163879317) # NOTE: missing PIJE data
laguna_110 <- (QUCH_leaf_area*0.018574086) # NOTE: missing PIJE data
laguna_111 <- (QUKE_leaf_area*0.111012804) # NOTE: missing PIJE & PICO data
laguna_112 <- (QUKE_leaf_area*0.346895411) # NOTE: missing PIJE & PICO data
laguna_113 <- (QUKE_leaf_area*0.228543739) # NOTE: missing PIJE & PICO data
laguna_114 <- (QUKE_leaf_area*0.098418239) 
laguna_115 <- (QUKE_leaf_area*0.168117903)

# community weighted mean vector
comm_weighted_mean <- c(laguna_80, laguna_81, laguna_82, laguna_83, laguna_85, laguna_86, laguna_87, laguna_88, laguna_89, laguna_90, laguna_91, laguna_92, laguna_93, laguna_95, laguna_97, laguna_98, laguna_99, laguna_105, laguna_106, laguna_107, laguna_108, laguna_109, laguna_110, laguna_111, laguna_112, laguna_113, laguna_114, laguna_115) %>%
  as.numeric()

# data frame w/ plot ID & community weighted mean
laguna_leaf_area <- data.frame(laguna_plots, comm_weighted_mean)

# bar plot of plot x community weighted means
laguna_box <-ggplot(laguna_leaf_area, aes(laguna_plots, comm_weighted_mean)) + 
  geom_col(fill = "darkseagreen") +
  xlab("Plot number") +
  ylab("Community weighted mean (cm^2)") +
  theme_bw() 

# laguna_leaf_area %>% mutate(laguna_plots = fct_relevel(laguna_plots, "80", "81", "82", "83", "85", "86", "87", "88", "89", "90", "91", "92", "93", "95", "97", "98", "99", "105", "106", "107", "108", "109", "110", "111", "112", "113", "114", "115")) %>%

laguna_box

## bluff mesa
```

## map building
```{r}
# creating a sample data.frame with your lat/lon points
lon <- c(-38.31,-35.5)
lat <- c(40.96, 37.5)
df <- as.data.frame(cbind(lon,lat))

# getting the map
mapzoe <- get_map(location = c(lon = mean(df$lon), lat = mean(df$lat)), zoom = 4,
                      maptype = "satellite", scale = 2)

# plotting the map with some points on it
ggmap(mapzoe) +
  geom_point(data = df, aes(x = lon, y = lat, fill = "red", alpha = 0.8), size = 5, shape = 21) +
  guides(fill=FALSE, alpha=FALSE, size=FALSE)
```


