---
title: "sr thesis components"
author: "Zoe Fung"
date: "8/31/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
# load required packages
library(readr)
library(ggplot2)
library(tibble)
library(ggmap)
library(janitor)
library(dplyr)
library(stringr)
library(tidyr)
```

## data cleaning 

### fire severity data

#### fire locations
```{r}
# load USDA 1 dataset
USDAfires <- read.csv("data/USDA_RDA_fires_list.csv") %>%
  clean_names() %>% # standardize dataset variable names
  filter(state=="California") # subset dataset to inlcude only CA fires
# create list of fires in CA from USDA 1 dataset
CAfires <- distinct(USDAfires,yr_fire_name)

# load USDA 1 fire severity dataset
USDAseverity <- read.csv("data/USDA_RDA_pre_post_trees.csv") %>%
  clean_names() %>% # standardize dataset variable names
  filter(yr_fire_name==c(CAfires$yr_fire_name)) # subset dataset to include only CA fires

# create list of fires in CA that have species & fire severity data
CAfires_clean <- distinct(USDAseverity,yr_fire_name)

# filter USDA fires dataset to only include CA fires w/ location, species, & fire severity data
USDAfires_clean <- USDAfires %>%
  filter(yr_fire_name %in% CAfires_clean$yr_fire_name) 

# create a .csv file for USDAfires_clean
write.csv(USDAfires_clean, "USDAfires_clean.csv") # how do i specify a path for this file to be created in the data folder?

# create vectors for lat, long, and fire year/name
latitude <- c(37.279, 37.857, 38.805437, 36.874, 37.279722)
longitude <- c(-119.318, -120.086, -120.629714, -118.905, -119.50014)
yr_fire_name <- c("2013 - Aspen", "2013 - Rim", "2014 - King", "2015 - Rough", "2015 - Willow")

# create dataframe 
USDA2fires_clean <- as.data.frame(cbind(yr_fire_name,latitude,longitude))

# create a .csv file for USDA2fires_clean
write.csv(USDA2fires_clean, "USDA2fires_clean.csv")

### PLOT locations for Nicole's data -- Laguna Mtn, Bluff Mesa, & Thomas fires
# read in all plot location data & organize
laguna_location <- read_csv("data/Nicole-data/LagunaMtn_plot_coordinates.csv") %>%
  clean_names() %>% # standardize column names
  select(site_year, plot_id, treatment_unit, easting, northing) %>% # subset data 
  as.data.frame() %>%
  drop_na("plot_id")
bluffmesa_location <- read_csv("data/Nicole-data/BluffMesa_plot_coordinates.csv") %>%
  clean_names() %>% # standardize column names
  select(site_year, plot_id, treatment_unit, easting, northing) %>% # subset data
  as.data.frame() %>%
  drop_na("plot_id")
thomas_location <- read_csv("data/Nicole-data/ThomasFire_plot_coordinates.csv") %>%
  clean_names() %>% # standardize column names
  select(site_year, plot_id, treatment_unit, easting, northing) %>% # subset data 
  as.data.frame() %>%
  drop_na("plot_id")
```

#### pre-fire: USDA/USFS data
```{r}
# load USDA 1 pre & post fire data
USDA1_prefire <- read.csv("data/USDA_RDA_pre_post_trees.csv") %>%
  clean_names() %>% # standardize column names
  filter(yr_fire_name %in% USDAfires_clean$yr_fire_name) %>%
  select(yr_fire_name, species, dataset, tree_num, genus, species_name, dbh_cm, drc_cm, ht_m, hcb_pre, cr_pre, cc, vr, cl_m) # subset data to only include CA fires w/ location, species, and fire severity data

# add latitude data
USDA1_prefire <- mutate(USDA1_prefire, latitude=case_when(
    str_detect(yr_fire_name, "1989 - SEKI Crystal") ~ "36.60068",
    str_detect(yr_fire_name, "SEKI Grant West I") ~ "36.74582",
    str_detect(yr_fire_name, "SEKI Highway 2") ~ "36.57336",
    str_detect(yr_fire_name, "SEKI Tharps") ~ "36.56328",
    str_detect(yr_fire_name, "SEKI Deer Creek PNF") ~ "36.57336",
    str_detect(yr_fire_name, "SEKI Grant West") ~ "36.74582",
    str_detect(yr_fire_name, "LAVO Knob/ Lost Creek") ~ "40.56738",
    str_detect(yr_fire_name, "SEKI Hole-inthe-Wall") ~ "36.78695",
    str_detect(yr_fire_name, "SEKI Picnic Estates") ~ "36.79198",
    str_detect(yr_fire_name, "Crystal") ~ "39.51724",
    str_detect(yr_fire_name, "LAVO Butte Lake") ~ "40.58129",
    str_detect(yr_fire_name, "SEKI Mineral King") ~ "36.46600",
    str_detect(yr_fire_name, "WHIS Brandy Creek") ~ "40.61878",
    str_detect(yr_fire_name, "1996 - WHIS Shasta Divide") ~ "40.57916",
    str_detect(yr_fire_name, "REDW Mainstem") ~ "41.12729",
    str_detect(yr_fire_name, "REDW Midbasin") ~ "41.13717",
    str_detect(yr_fire_name, "Bucks") ~ "39.88539",
    str_detect(yr_fire_name, "SEKI Hercules") ~ "36.56936",
    str_detect(yr_fire_name, "SEKI Mineral KingS10") ~ "36.46601",
    str_detect(yr_fire_name, "Storrie") ~ "40.02744",
    str_detect(yr_fire_name, "Volcano Spring") ~ "39.15980",
    str_detect(yr_fire_name, "FSS2") ~ "36.59506",
    str_detect(yr_fire_name, "FSS5") ~ "36.58481",
    str_detect(yr_fire_name, "FSS6") ~ "36.58518",
    str_detect(yr_fire_name, "Southern Cascades Goosenest CA 174") ~ "41.54627",
    str_detect(yr_fire_name, "Southern Cascades Goosenest CA 178") ~ "41.56750",
    str_detect(yr_fire_name, "Southern Cascades Goosenest CA 179") ~ "41.58725",
    str_detect(yr_fire_name, "Southern Sierra Nevada Sequoia CA 1") ~ "36.59455",
    str_detect(yr_fire_name, "Southern Sierra Nevada Sequoia CA 4") ~ "36.58567",
    str_detect(yr_fire_name, "Southern Sierra Nevada Sequoia CA 5") ~ "36.58582",
    str_detect(yr_fire_name, "Star") ~ "39.09857",
    str_detect(yr_fire_name, "Swain") ~ "40.67535",
    str_detect(yr_fire_name, "Blodgett 129 - 60") ~ "38.91730",
    str_detect(yr_fire_name, "Blodgett 130 - 340") ~ "38.89821",
    str_detect(yr_fire_name, "Blodgett 131 - 400") ~ "38.89666",
    str_detect(yr_fire_name, "Cone") ~ "40.75172",
    str_detect(yr_fire_name, "McNalley") ~ "36.57336",
    str_detect(yr_fire_name, "REDW Copper Creek") ~ "41.15085",
    str_detect(yr_fire_name, "Southern Cascades Goosenest CA 181") ~ "41.60037",
    str_detect(yr_fire_name, "Southern Cascades Goosenest CA 182") ~ "41.56346",
    str_detect(yr_fire_name, "Southern Cascades Goosenest CA 183") ~ "41.55452",
    str_detect(yr_fire_name, "Southern Sierra Nevada Sequoia CA 2") ~ "36.59416",
    str_detect(yr_fire_name, "Southern Sierra Nevada Sequoia CA 3") ~ "36.59189",
    str_detect(yr_fire_name, "Southern Sierra Nevada Sequoia CA 8") ~ "36.57340",
    str_detect(yr_fire_name, "LABE South Boundary") ~ "41.69815",
    str_detect(yr_fire_name, "2003 - WHIS Shasta Divide") ~ "40.57916",
    str_detect(yr_fire_name, "Power") ~ "38.50190",
    str_detect(yr_fire_name, "Tennant") ~ "41.55805",
    str_detect(yr_fire_name, "Tharps2") ~ "36.56328",
    str_detect(yr_fire_name, "Harding") ~ "39.63345",
    str_detect(yr_fire_name, "SEKI Lewis Creek") ~ "36.76013",
    str_detect(yr_fire_name, "Angora") ~ "38.88529",
    str_detect(yr_fire_name, "Antelope") ~ "40.14120",
    str_detect(yr_fire_name, "Grass Valley") ~ "34.26739",
    str_detect(yr_fire_name, "PW-4") ~ "37.80125",
    str_detect(yr_fire_name, "American River Complex") ~ "39.22988",
    str_detect(yr_fire_name, "Peterson") ~ "40.89497",
    str_detect(yr_fire_name, "Piute") ~ "35.48923",
    str_detect(yr_fire_name, "Rich") ~ "40.06137",
    str_detect(yr_fire_name, "2008 - Seki Crystal") ~ "36.60068",
    str_detect(yr_fire_name, "WHIS White Rock") ~ "40.64606",
    str_detect(yr_fire_name, "Milford") ~ "40.10646",
    str_detect(yr_fire_name, "REDW Eastside") ~ "41.14705",
    str_detect(yr_fire_name, "Mountain") ~ "33.71030",
    str_detect(yr_fire_name, "Rim") ~ "37.90192",
    str_detect(yr_fire_name, "Salmon Complex") ~ "41.31864",
    str_detect(yr_fire_name, "Wooded Hills") ~ "32.85336"
  ))

# add longitude data
USDA1_prefire <- mutate(USDA1_prefire, longitude=case_when(
    str_detect(yr_fire_name, "1989 - SEKI Crystal") ~ "-118.8102",
    str_detect(yr_fire_name, "SEKI Grant West I") ~ "-118.9772",
    str_detect(yr_fire_name, "SEKI Highway 2") ~ "-118.7604",
    str_detect(yr_fire_name, "SEKI Tharps") ~ "-118.7428",
    str_detect(yr_fire_name, "SEKI Deer Creek PNF") ~ "-118.6585", 
    str_detect(yr_fire_name, "SEKI Grant West") ~ "-118.9772",
    str_detect(yr_fire_name, "LAVO Knob/ Lost Creek") ~ "-121.5252",
    str_detect(yr_fire_name, "SEKI Hole-inthe-Wall") ~ "-118.6302",
    str_detect(yr_fire_name, "SEKI Picnic Estates") ~ "-118.6669",
    str_detect(yr_fire_name, "Crystal") ~ "-120.0372",
    str_detect(yr_fire_name, "LAVO Butte Lake") ~ "-121.2966",
    str_detect(yr_fire_name, "SEKI Mineral King") ~ "-118.6934",
    str_detect(yr_fire_name, "WHIS Brandy Creek") ~ "-122.5739",
    str_detect(yr_fire_name, "1996 - WHIS Shasta Divide") ~ "-122.5247",
    str_detect(yr_fire_name, "REDW Mainstem") ~ "-123.8691",
    str_detect(yr_fire_name, "REDW Midbasin") ~ "-123.8881",
    str_detect(yr_fire_name, "Bucks") ~ "-121.3127",
    str_detect(yr_fire_name, "SEKI Hercules") ~ "-118.7515",
    str_detect(yr_fire_name, "SEKI Mineral KingS10") ~ "-118.6935",
    str_detect(yr_fire_name, "Storrie") ~ "-121.2872",
    str_detect(yr_fire_name, "Volcano Spring") ~ "-120.6647",
    str_detect(yr_fire_name, "FSS2") ~ "-118.7470",
    str_detect(yr_fire_name, "FSS5") ~ "-118.7552",
    str_detect(yr_fire_name, "FSS6") ~ "-118.7596",
    str_detect(yr_fire_name, "Southern Cascades Goosenest CA 174") ~ "-121.8868",
    str_detect(yr_fire_name, "Southern Cascades Goosenest CA 178") ~ "-121.8468",
    str_detect(yr_fire_name, "Southern Cascades Goosenest CA 179") ~ "-121.8417",
    str_detect(yr_fire_name, "Southern Sierra Nevada Sequoia CA 1") ~ "-118.7470",
    str_detect(yr_fire_name, "Southern Sierra Nevada Sequoia CA 4") ~ "-118.7549",
    str_detect(yr_fire_name, "Southern Sierra Nevada Sequoia CA 5") ~ "-118.7592",
    str_detect(yr_fire_name, "Star") ~ "-120.4895",
    str_detect(yr_fire_name, "Swain") ~ "-121.2609",
    str_detect(yr_fire_name, "Blodgett 129 - 60") ~ "-120.6639",
    str_detect(yr_fire_name, "Blodgett 130 - 340") ~ "-120.6545",
    str_detect(yr_fire_name, "Blodgett 131 - 400") ~ "-120.6489",
    str_detect(yr_fire_name, "Cone") ~ "-121.1582",
    str_detect(yr_fire_name, "McNalley") ~ "-118.4001",
    str_detect(yr_fire_name, "REDW Copper Creek") ~ "-123.8945",
    str_detect(yr_fire_name, "Southern Cascades Goosenest CA 181") ~ "-121.8468",
    str_detect(yr_fire_name, "Southern Cascades Goosenest CA 182") ~ "-121.8937",
    str_detect(yr_fire_name, "Southern Cascades Goosenest CA 183") ~ "-121.8638",
    str_detect(yr_fire_name, "Southern Sierra Nevada Sequoia CA 2") ~ "-118.7520",
    str_detect(yr_fire_name, "Southern Sierra Nevada Sequoia CA 3") ~ "-118.7552",
    str_detect(yr_fire_name, "Southern Sierra Nevada Sequoia CA 8") ~ "-118.7721",
    str_detect(yr_fire_name, "LABE South Boundary") ~ "-121.5030",
    str_detect(yr_fire_name, "2003 - WHIS Shasta Divide") ~ "-122.5247",
    str_detect(yr_fire_name, "Power") ~ "-120.2801",
    str_detect(yr_fire_name, "Tennant") ~ "-121.9136",
    str_detect(yr_fire_name, "Tharps2") ~ "-118.7428",
    str_detect(yr_fire_name, "Harding") ~ "-120.3098",
    str_detect(yr_fire_name, "SEKI Lewis Creek") ~ "-118.7051",
    str_detect(yr_fire_name, "Angora") ~ "-120.0365",
    str_detect(yr_fire_name, "Antelope") ~ "-120.5751",
    str_detect(yr_fire_name, "Grass Valley") ~ "-117.2301",
    str_detect(yr_fire_name, "PW-4") ~ "-119.8694",
    str_detect(yr_fire_name, "American River Complex") ~ "-120.6351",
    str_detect(yr_fire_name, "Peterson") ~ "-121.3170",
    str_detect(yr_fire_name, "Piute") ~ "-118.3568",
    str_detect(yr_fire_name, "Rich") ~ "-121.1244",
    str_detect(yr_fire_name, "2008 - Seki Crystal") ~ "-118.8102",
    str_detect(yr_fire_name, "WHIS White Rock") ~ "-122.5381",
    str_detect(yr_fire_name, "Milford") ~ "-120.3957",
    str_detect(yr_fire_name, "REDW Eastside") ~ "-123.8678",
    str_detect(yr_fire_name, "Mountain") ~ "--116.7062",
    str_detect(yr_fire_name, "Rim") ~ "--120.0836",
    str_detect(yr_fire_name, "Salmon Complex") ~ "-123.1824",
    str_detect(yr_fire_name, "Wooded Hills") ~ "-116.4381"
  ))

# determine how many data points are available for pre-fire data (include dbh measurements)
USDA1_prefire <- drop_na(USDA1_prefire, dbh_cm) %>% # 23,509 DBH data points
  distinct(yr_fire_name, species, dataset, tree_num, genus, species_name, dbh_cm, drc_cm, ht_m, hcb_pre, cr_pre, cc, vr, cl_m) # drop duplicate rows

# identify the species for which pre/post-fire data exists
USDA1_species <- distinct(USDA1_prefire, species)

# create list of the CA fires w/ pre-fire data available
USDA1pre_fires_list <- distinct(USDA1_prefire,yr_fire_name)

# create a dataset with only fire name, latitude, and longitude for pre-fire data
USDA1prefire_clean <- USDA1_prefire[, c("yr_fire_name", "latitude", "longitude")]

# remove repeat rows: keep only 1 row for each set of fire/coordinates
USDA1prefire_clean <- distinct(USDA1prefire_clean)

# write csv for USDA1 prefire data
write.csv(USDA1prefire_clean, "USDA1prefire_clean.csv")

# test mutate on a smaller data table
prefiretest <- slice(USDA1_prefire, 1:5) %>% # select first 5 rows of USDA1 prefire
  select(yr_fire_name, species, dataset) %>% # only keep first 3 variables
  mutate(latitude=case_when(
    str_detect(yr_fire_name, "Grass Valley") ~ "34.26739",
    str_detect(yr_fire_name, "FSS2") ~ "36.59506",
    str_detect(yr_fire_name, "FSS5") ~ "36.58481",
    str_detect(yr_fire_name, "McNalley") ~ "36.57336")) # add latitude column

# create data frame for USDA 1 post-fire data
USDA1_postfire <- read.csv("data/USDA_RDA_pre_post_trees.csv") %>%
  clean_names() %>% # standardize variable names
  filter(yr_fire_name %in% USDAfires_clean$yr_fire_name) %>%
  select(yr_fire_name, species, dataset, times_burned, tree_num, genus, species_name, csh_m, cls_m, clk_m, cls_percent, clk_percent, cvs_percent, cvk_percent, cbs, bcha_m, bchm_m, bch_percent, bca, ckr, gca, gir_percent) # select only columns relating to post-fire measurements

# determine how many data points are available for post-fire data (include crown scorch height & max bole char height measurements)
USDA1_postfire <- drop_na(USDA1_postfire, csh_m) %>% 
  drop_na(bchm_m) %>% 
  distinct(yr_fire_name, species, dataset, tree_num, genus, species_name, csh_m, cls_m, clk_m, cls_percent, clk_percent, cvs_percent, cvk_percent, cbs, bcha_m, bchm_m, bch_percent, bca, ckr, gca, gir_percent) # drop duplicate rows -- 6,970 data points w/ both crown scorch height and max bole char height

# load USDA 2 pre & post fire data
crag <- read.csv("data/USDA:USFS/2005_Crag/!FBAT_Trees_Crag_Rawdata")
```

#### pre-fire - Nicole's data
```{r}
# load in all pre-fire data & organize
laguna_pre <- read_csv("data/Nicole-data/LagunaMtn_pre_2016.csv")  %>%
  clean_names() %>% # standardize column names
  select(project, date, id, treatment, tag_number, status, species, dbh_cm, height_m, heigt_to_crown_m, dbh_ft, basal_area_sq_ft_indiv) %>% # subset data 
  as.data.frame()%>%
  rename("height_to_crown_m"="heigt_to_crown_m", "plot_id"="id", "treatment_unit"="treatment") %>%
  mutate(tree_area = ((pi*(laguna_pre$dbh_cm^2)/4)/100)) # add column w/ area measurements for each tree
bluffmesa_pre <- read_csv("data/Nicole-data/BluffMesa_pre_2016.csv") %>%
  clean_names() %>% # standardize column names
  select(project, date, id, treatment, tag_number, status, species, dbh_cm, height_m, heigt_to_crown_m, dbh_ft, ba_indiv_sq_ft) %>% # subset data 
  as.data.frame() %>%
  rename("height_to_crown_m"="heigt_to_crown_m", "plot_id"="id", "treatment_unit"="treatment", "basal_area_sq_ft_indiv"="ba_indiv_sq_ft") %>%
  mutate(tree_area = ((pi*(bluffmesa_pre$dbh_cm^2)/4)/100)) # add column with area measurements for each tree

# since location data is organized by PLOT, find tree area per plot (subset by species)
laguna_species <- unique(laguna_pre$species) # create list of all species present in laguna fire data
laguna_pre <- laguna_pre %>%
  drop_na("species") # drop rows where species is not specified

laguna_pre_PIJE <- filter(laguna_pre, species == "PIJE") # create data frame w/ only PIJE sp.
laguna_pre_QUCH <- filter(laguna_pre, species == "QUCH") # create data frame w/ only QUCH sp.
laguna_pre_QUKE <- filter(laguna_pre, species == "QUKE") # create data frame w/ only QUKE sp.
laguna_pre_PICO <- filter(laguna_pre, species == "PICO") # create data frame w/ only PICO sp.
laguna_pre_CADE <- filter(laguna_pre, species == "CADE") # create data frame w/ only CADE sp.

#### PIJE

laguna_pre_PIJE_plots <- unique(laguna_pre_PIJE$plot_id) # print each plot ID where PIJE is present

# create a data frame for each plot 
## NOTE: each plot is an 11.3m radius circular plot
laguna_pre_PIJE_80 <- filter(laguna_pre_PIJE, plot_id == "80")
laguna_pre_PIJE_81 <- filter(laguna_pre_PIJE, plot_id == "81")
laguna_pre_PIJE_82 <- filter(laguna_pre_PIJE, plot_id == "82")
laguna_pre_PIJE_83 <- filter(laguna_pre_PIJE, plot_id == "83")
laguna_pre_PIJE_85 <- filter(laguna_pre_PIJE, plot_id == "85")
laguna_pre_PIJE_86 <- filter(laguna_pre_PIJE, plot_id == "86")
laguna_pre_PIJE_87 <- filter(laguna_pre_PIJE, plot_id == "87")
laguna_pre_PIJE_88 <- filter(laguna_pre_PIJE, plot_id == "88")
laguna_pre_PIJE_89 <- filter(laguna_pre_PIJE, plot_id == "89")
laguna_pre_PIJE_90 <- filter(laguna_pre_PIJE, plot_id == "90")
laguna_pre_PIJE_91 <- filter(laguna_pre_PIJE, plot_id == "91")
laguna_pre_PIJE_92 <- filter(laguna_pre_PIJE, plot_id == "92")
laguna_pre_PIJE_93 <- filter(laguna_pre_PIJE, plot_id == "93")
laguna_pre_PIJE_97 <- filter(laguna_pre_PIJE, plot_id == "97")
laguna_pre_PIJE_98 <- filter(laguna_pre_PIJE, plot_id == "98")
laguna_pre_PIJE_99 <- filter(laguna_pre_PIJE, plot_id == "99")
laguna_pre_PIJE_105 <- filter(laguna_pre_PIJE, plot_id == "105")
laguna_pre_PIJE_106 <- filter(laguna_pre_PIJE, plot_id == "106")
laguna_pre_PIJE_107 <- filter(laguna_pre_PIJE, plot_id == "107")
laguna_pre_PIJE_108 <- filter(laguna_pre_PIJE, plot_id == "108")
laguna_pre_PIJE_109 <- filter(laguna_pre_PIJE, plot_id == "109")
laguna_pre_PIJE_110 <- filter(laguna_pre_PIJE, plot_id == "110")
laguna_pre_PIJE_111 <- filter(laguna_pre_PIJE, plot_id == "111")
laguna_pre_PIJE_112 <- filter(laguna_pre_PIJE, plot_id == "112")
laguna_pre_PIJE_113 <- filter(laguna_pre_PIJE, plot_id == "113")

# calculate plot area
plot_area <- pi*(11.3^2)
## plot area = 401.15m^2

# create vectors of the sum of each species' area per plot
l_p_80 <- sum(laguna_pre_PIJE_80$tree_area)
l_p_81 <- sum(laguna_pre_PIJE_81$tree_area)
l_p_82 <- sum(laguna_pre_PIJE_82$tree_area)
l_p_83 <- sum(laguna_pre_PIJE_83$tree_area)
l_p_85 <- sum(laguna_pre_PIJE_85$tree_area)
l_p_86 <- sum(laguna_pre_PIJE_86$tree_area)
l_p_87 <- sum(laguna_pre_PIJE_87$tree_area)
l_p_88 <- sum(laguna_pre_PIJE_88$tree_area)
l_p_89 <- sum(laguna_pre_PIJE_89$tree_area)
l_p_90 <- sum(laguna_pre_PIJE_90$tree_area)
l_p_91 <- sum(laguna_pre_PIJE_91$tree_area)
l_p_92 <- sum(laguna_pre_PIJE_92$tree_area)
l_p_93 <- sum(laguna_pre_PIJE_93$tree_area)
l_p_97 <- sum(laguna_pre_PIJE_97$tree_area)
l_p_98 <- sum(laguna_pre_PIJE_98$tree_area)
l_p_99 <- sum(laguna_pre_PIJE_99$tree_area)
l_p_105 <- sum(laguna_pre_PIJE_105$tree_area)
l_p_106 <- sum(laguna_pre_PIJE_106$tree_area)
l_p_107 <- sum(laguna_pre_PIJE_107$tree_area)
l_p_108 <- sum(laguna_pre_PIJE_108$tree_area)
l_p_109 <- sum(laguna_pre_PIJE_109$tree_area)
l_p_110 <- sum(laguna_pre_PIJE_110$tree_area)
l_p_111 <- sum(laguna_pre_PIJE_111$tree_area)
l_p_112 <- sum(laguna_pre_PIJE_112$tree_area)
l_p_113 <- sum(laguna_pre_PIJE_113$tree_area)

# create data frame: project, year, plot_id, & abundance for PIJE
laguna_pre_PIJE_clean <- data.frame(
  project = rep("Laguna Mtn.", times = length(laguna_pre_PIJE_plots)), 
  year = rep("2016", times = length(laguna_pre_PIJE_plots)),
  plot_id = c(laguna_pre_PIJE_plots),
  abundance = c(l_p_80/plot_area, l_p_81/plot_area, l_p_82/plot_area, l_p_83/plot_area, l_p_85/plot_area, l_p_86/plot_area, l_p_87/plot_area, l_p_88/plot_area, l_p_89/plot_area, l_p_90/plot_area, l_p_91/plot_area, l_p_92/plot_area, l_p_93/plot_area, l_p_97/plot_area, l_p_98/plot_area, l_p_99/plot_area, l_p_105/plot_area, l_p_106/plot_area, l_p_107/plot_area, l_p_108/plot_area, l_p_109/plot_area, l_p_110/plot_area, l_p_111/plot_area, l_p_112/plot_area, l_p_113/plot_area)
)

#### QUCH

laguna_pre_QUCH_plots <- unique(laguna_pre_QUCH$plot_id) # print each plot ID where QUCH is present

# create a data frame for each plot 
## NOTE: each plot is an 11.3m radius circular plot
laguna_pre_QUCH_80 <- filter(laguna_pre_QUCH, plot_id == "80")
laguna_pre_QUCH_81 <- filter(laguna_pre_QUCH, plot_id == "81")
laguna_pre_QUCH_82 <- filter(laguna_pre_QUCH, plot_id == "82")
laguna_pre_QUCH_83 <- filter(laguna_pre_QUCH, plot_id == "83")
laguna_pre_QUCH_87 <- filter(laguna_pre_QUCH, plot_id == "87")
laguna_pre_QUCH_110 <- filter(laguna_pre_QUCH, plot_id == "110")

## plot area = 401.15m^2

# create vectors of the sum of each species' area per plot
l_qc_80 <- sum(laguna_pre_QUCH_80$tree_area)
l_qc_81 <- sum(laguna_pre_QUCH_81$tree_area)
l_qc_82 <- sum(laguna_pre_QUCH_82$tree_area)
l_qc_83 <- sum(laguna_pre_QUCH_83$tree_area)
l_qc_87 <- sum(laguna_pre_QUCH_87$tree_area)
l_qc_110 <- sum(laguna_pre_QUCH_110$tree_area)

# create data frame: project, year, plot_id, & abundance for PIJE
laguna_pre_QUCH_clean <- data.frame(
  project = rep("Laguna Mtn.", times = length(laguna_pre_QUCH_plots)), # how do i get the length to match the vector length rather than having to manually type in a length?
  year = rep("2016", times = length(laguna_pre_QUCH_plots)),
  plot_id = c(laguna_pre_QUCH_plots),
  abundance = c(l_qc_80/plot_area, l_qc_81/plot_area, l_qc_82/plot_area, l_qc_83/plot_area, l_qc_87/plot_area, l_qc_110/plot_area)
)

#### QUKE

laguna_pre_QUKE_plots <- unique(laguna_pre_QUKE$plot_id) # print each plot ID where QUKE is present

# create a data frame for each plot 
## NOTE: each plot is an 11.3m radius circular plot
laguna_pre_QUKE_80 <- filter(laguna_pre_QUKE, plot_id == "80")
laguna_pre_QUKE_81 <- filter(laguna_pre_QUKE, plot_id == "81")
laguna_pre_QUKE_82 <- filter(laguna_pre_QUKE, plot_id == "82")
laguna_pre_QUKE_83 <- filter(laguna_pre_QUKE, plot_id == "83")
laguna_pre_QUKE_85 <- filter(laguna_pre_QUKE, plot_id == "85")
laguna_pre_QUKE_86 <- filter(laguna_pre_QUKE, plot_id == "86")
laguna_pre_QUKE_87 <- filter(laguna_pre_QUKE, plot_id == "87")
laguna_pre_QUKE_88 <- filter(laguna_pre_QUKE, plot_id == "88")
laguna_pre_QUKE_91 <- filter(laguna_pre_QUKE, plot_id == "91")
laguna_pre_QUKE_92 <- filter(laguna_pre_QUKE, plot_id == "92")
laguna_pre_QUKE_93 <- filter(laguna_pre_QUKE, plot_id == "93")
laguna_pre_QUKE_95 <- filter(laguna_pre_QUKE, plot_id == "95")
laguna_pre_QUKE_97 <- filter(laguna_pre_QUKE, plot_id == "97")
laguna_pre_QUKE_98 <- filter(laguna_pre_QUKE, plot_id == "98")
laguna_pre_QUKE_99 <- filter(laguna_pre_QUKE, plot_id == "99")
laguna_pre_QUKE_105 <- filter(laguna_pre_QUKE, plot_id == "105")
laguna_pre_QUKE_108 <- filter(laguna_pre_QUKE, plot_id == "108")
laguna_pre_QUKE_109 <- filter(laguna_pre_QUKE, plot_id == "109")
laguna_pre_QUKE_111 <- filter(laguna_pre_QUKE, plot_id == "111")
laguna_pre_QUKE_112 <- filter(laguna_pre_QUKE, plot_id == "112")
laguna_pre_QUKE_113 <- filter(laguna_pre_QUKE, plot_id == "113")
laguna_pre_QUKE_114 <- filter(laguna_pre_QUKE, plot_id == "114")
laguna_pre_QUKE_115 <- filter(laguna_pre_QUKE, plot_id == "115")

## plot area = 401.15m^2

# create vectors of the sum of each species' area per plot
l_qk_80 <- sum(laguna_pre_QUKE_80$tree_area)
l_qk_81 <- sum(laguna_pre_QUKE_81$tree_area)
l_qk_82 <- sum(laguna_pre_QUKE_82$tree_area)
l_qk_83 <- sum(laguna_pre_QUKE_83$tree_area)
l_qk_85 <- sum(laguna_pre_QUKE_85$tree_area)
l_qk_86 <- sum(laguna_pre_QUKE_86$tree_area)
l_qk_87 <- sum(laguna_pre_QUKE_87$tree_area)
l_qk_88 <- sum(laguna_pre_QUKE_88$tree_area)
l_qk_91 <- sum(laguna_pre_QUKE_91$tree_area)
l_qk_92 <- sum(laguna_pre_QUKE_92$tree_area)
l_qk_93 <- sum(laguna_pre_QUKE_93$tree_area)
l_qk_95 <- sum(laguna_pre_QUKE_95$tree_area)
l_qk_97 <- sum(laguna_pre_QUKE_97$tree_area)
l_qk_98 <- sum(laguna_pre_QUKE_98$tree_area)
l_qk_99 <- sum(laguna_pre_QUKE_99$tree_area)
l_qk_105 <- sum(laguna_pre_QUKE_105$tree_area)
l_qk_108 <- sum(laguna_pre_QUKE_108$tree_area)
l_qk_109 <- sum(laguna_pre_QUKE_109$tree_area)
l_qk_111 <- sum(laguna_pre_QUKE_111$tree_area)
l_qk_112 <- sum(laguna_pre_QUKE_112$tree_area)
l_qk_113 <- sum(laguna_pre_QUKE_113$tree_area)
l_qk_114 <- sum(laguna_pre_QUKE_114$tree_area)
l_qk_115 <- sum(laguna_pre_QUKE_115$tree_area)

# create data frame: project, year, plot_id, & abundance for PIJE
laguna_pre_QUKE_clean <- data.frame(
  project = rep("Laguna Mtn.", times = length(laguna_pre_QUKE_plots)), 
  year = rep("2016", times = length(laguna_pre_QUKE_plots)),
  plot_id = c(laguna_pre_QUKE_plots),
  abundance = c(l_qk_80/plot_area, l_qk_81/plot_area, l_qk_82/plot_area, l_qk_83/plot_area, l_qk_85/plot_area, l_qk_86/plot_area, l_qk_87/plot_area, l_qk_88/plot_area, l_qk_91/plot_area, l_qk_92/plot_area, l_qk_93/plot_area, l_qk_95/plot_area, l_qk_97/plot_area, l_qk_98/plot_area, l_qk_99/plot_area, l_qk_105/plot_area, l_qk_108/plot_area, l_qk_109/plot_area, l_qk_111/plot_area, l_qk_112/plot_area, l_qk_113/plot_area, l_qk_114/plot_area, l_qk_115/plot_area)
)

#### PICO

laguna_pre_PICO_plots <- unique(laguna_pre_PICO$plot_id) # print each plot ID where PICO is present

# create a data frame for each plot 
## NOTE: each plot is an 11.3m radius circular plot
laguna_pre_PICO_89 <- filter(laguna_pre_PICO, plot_id == "89")
laguna_pre_PICO_90 <- filter(laguna_pre_PICO, plot_id == "90")
laguna_pre_PICO_91 <- filter(laguna_pre_PICO, plot_id == "91")
laguna_pre_PICO_111 <- filter(laguna_pre_PICO, plot_id == "111")
laguna_pre_PICO_112 <- filter(laguna_pre_PICO, plot_id == "112")
laguna_pre_PICO_113 <- filter(laguna_pre_PICO, plot_id == "113")

## plot area = 401.15m^2

# create vectors of the sum of each species' area per plot
l_pc_89 <- sum(laguna_pre_PICO_89$tree_area)
l_pc_90 <- sum(laguna_pre_PICO_90$tree_area)
l_pc_91 <- sum(laguna_pre_PICO_91$tree_area)
l_pc_111 <- sum(laguna_pre_PICO_111$tree_area)
l_pc_112 <- sum(laguna_pre_PICO_112$tree_area)
l_pc_113 <- sum(laguna_pre_PICO_113$tree_area)

# create data frame: project, year, plot_id, & abundance for PICO
laguna_pre_PICO_clean <- data.frame(
  project = rep("Laguna Mtn.", times = length(laguna_pre_PICO_plots)), 
  year = rep("2016", times = length(laguna_pre_PICO_plots)),
  plot_id = c(laguna_pre_PICO_plots),
  abundance = c(l_pc_89/plot_area, l_pc_90/plot_area, l_pc_91/plot_area, l_pc_111/plot_area, l_pc_112/plot_area, l_pc_113/plot_area)
)
```

### post-fire data
#### Nicole's data
```{r}
# load in all post-fire data
laguna_post <- read_csv("data/Nicole-data/LagunaMtn_post_2017.csv")
bluffmeas_post <- read_csv("data/Nicole-data/BluffMesa_post_2021.csv")
thomas_post1 <- read_csv("data/Nicole-data/ThomasFire_post_2018.csv")
thomas_post2 <- read_csv("data/Nicole-data/ThomasFire_post_2018_2.csv")
```

### vegetation data
```{r}
# load vegetation data
vegetation <- read.csv("data/VTM_species_location.csv")
```

### leaf trait data
```{r}
# load leaf trait dataset
leaf_traits_summary <- read.csv("data/LDMC-LL-LLength.csv")

```

## map building
```{r}
# creating a sample data.frame with your lat/lon points
lon <- c(-38.31,-35.5)
lat <- c(40.96, 37.5)
df <- as.data.frame(cbind(lon,lat))

# getting the map
mapzoe <- get_map(location = c(lon = mean(df$lon), lat = mean(df$lat)), zoom = 4,
                      maptype = "satellite", scale = 2)

# plotting the map with some points on it
ggmap(mapzoe) +
  geom_point(data = df, aes(x = lon, y = lat, fill = "red", alpha = 0.8), size = 5, shape = 21) +
  guides(fill=FALSE, alpha=FALSE, size=FALSE)
```


